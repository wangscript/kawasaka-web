(function(){window["Wade"]={};Wade.get=System.get;Wade.fly=System.fly;Wade.query=System.query;Wade.onReady=System.onReady;Wade.onLoad=System.onLoad;var dh=System.DomHelper;var wade_datafilter=/[^0-9a-zA-Z\u4E00-\u9FA5\u3000-\u303F\uFF00-\uFFEF\s_~=@#%&*<>.,':;\|\/\?\-\+\[\]\{\}\(\)\"]/ig;var wade_datareplacer=/([0-9a-zA-Z_])(=)([\[\{])/ig;window["Browser"]={isIE:System.UserAgent.ie,isIE7:System.UserAgent.ie7,isFF:System.UserAgent.gecko,isSafari:System.UserAgent.safari};Wade.pub=function(o){ if(o && typeof(o)=='object'){  for(var p in o){   if(o[p] && typeof(o[p])=='function'){window[p]=o[p];}  } }};function parseJson(str){ if(typeof(str)!="string" || str==""){return "";} str=str.replace(wade_datafilter,""); str=str.replace(wade_datareplacer,"$1:$3"); str=str.replace(/\r|\t|\n/g,function(m){   switch(m){    case "\r":m="\u005Cr";break;    case "\t":m="\u005Ct";break;    case "\n":m="\u005Cn";break;   }return m;});   str=str.replace(/([^,:\{\[])(")([^,:\}\]])/g,"$1\u005C$2$3"); return str;};Wade.DataMap=function(data){ Wade.DataMap.superclass.constructor.call(this);  if(typeof(data)=="string" && data!="")this.parseString(data); if(typeof(data)=="object")this.parseObject(data);};System.extend(Wade.DataMap,System.MixedCollection,{ get:function(key,defaultValue){  var r=this.item(key);  if(arguments.length>1 && (typeof(r)=="undefined" || r==null))   return arguments[1];  return r; }, parseString:function(str){  str=parseJson(str);  try{   eval("var o=" +str);   if(typeof(o)=="object")this.parseObject(o);  }catch(ex){alert("DATA TRANSFER ERROR:\r\nERROR NAME:" + ex["name"] + "\r\nError MESSAGE:" + ex["message"] + "\r\nDATA STR:"+ str);} }, parseObject:function(o){  for(var p in o){   if(typeof(o[p])=="object" && (o[p] instanceof Array)){    if(o[p].length>1 || (o[p].length==1 && typeof(o[p][0])!="string")){this.add(p,new Wade.DatasetList(o[p]));}    else if(o[p].length){this.add(p,o[p][0]);}   }else if(typeof(o[p])=="object"){this.add(p,new Wade.DataMap(o[p]));}   else {this.add(p,o[p]);}   } }, fillFormElements:function(form){  Wade.dom.fillFormElementsValues(this,form); }});Wade.DataMap.prototype.toString=function(wadeMode){  var cl=[],is="",wm=(wadeMode==true);  for(var key in this.map){   is=(wm?"":"\"") + key + (wm?"":"\"") +":";   if(typeof(this.map[key])=="undefined" || this.map[key]==null){is+=(wm?"[":"")+"\"\"" +(wm?"]":"");}   else if(typeof(this.map[key])=="string" || !isNaN(this.map[key])){is+=(wm?"[":"")+"\"" + this.map[key] + "\""+(wm?"]":"");}   else{is+=this.map[key].toString(wadeMode);}   cl.push(is);is="";  }  return "{" + cl.join("," + (wm?" ":"")) + "}";};Wade.DataMap.prototype.put=Wade.DataMap.prototype.add;Wade.DatasetList=function(o){ Wade.DatasetList.superclass.constructor.call(this);  this.items = []; this.length=0; this.addEvents({  "add":true }); if(typeof(o)=="string" && o!="")this.parseString(o); if(typeof(o)=="object" && (o instanceof Array) && o.length)this.parseArray(o);};System.extend(Wade.DatasetList,System.Event.Observable,{ add:function(o){  this.length=(this.length+1);        this.items.push(o); },    item: function(index,key,defaultValue){     if(index < this.length && index >= 0){         var r= this.items[index];         if((typeof(r)!="undefined") && (r instanceof Wade.DataMap)          && arguments.length>1 && typeof(arguments[1])=="string"          && arguments[1]!="" ){return r.get(key,defaultValue);}         return r;     }return;    },     each : function(fn, scope){        var items = [].concat(this.items);         for(var i = 0, len = items.length; i < len; i=i+1){            if(fn.call(scope || items[i], items[i], i, len) === false){                break;            }        }    },       remove : function(o){        return this.removeAt(this.indexOf(o));    },  removeAt:function(index){        if(index < this.length && index >= 0){            this.length=(this.length-1);            this.items.splice(index, 1);        }   },    indexOf : function(o){        if(!this.items.indexOf){            for(var i = 0, len = this.items.length; i < len; i=i+1){                if(this.items[i] == o){ return i;}            }            return -1;        }else{            return this.items.indexOf(o);        }    },     getCount:function(){        return this.length;     },  parseString:function(str){  str=parseJson(str);  try{   eval("var o=" +str);   if(typeof(o)=="object" && (o instanceof Array) && o.length)this.parseArray(o);  }catch(ex){alert("DATA TRANSFER ERROR:\r\nERROR NAME:" + ex["name"] + "\r\nError MESSAGE:" + ex["message"] + "\r\nDATA STR:"+ str);}   }, parseArray:function(o){  for(var i=0;i<o.length;i++){     if(typeof(o[i]) =="object" && (o[i] instanceof Array)){this.add(new Wade.DatasetList(o[i]));}     else if(typeof(o[i]) =="object"){this.add(new Wade.DataMap(o[i]));}     else {this.add(o[i]);}  } }, clear:function(){  this.items =[];  this.length=0;  System.CG(); }});Wade.DatasetList.prototype.toString=function(wadeMode){ var cl=[],is="",wm=(wadeMode==true); for(var i=0;i<this.items.length;i++){  if(typeof(this.items[i])=="undefined" || this.items[i]==null){is+="\"\"";}  else if(typeof(this.items[i])=="string"){is="\"" + this.items[i] + "\"";}  else{is=this.items[i].toString(wadeMode);}  cl.push(is);is=""; } return "[" + cl.join("," +(wm?" ":"")) + "]";};Wade.DatasetList.prototype.get=Wade.DatasetList.prototype.item;Wade.util=(function(){ Array.prototype.swap = function (i, j) {  var temp = this[i];  this[i] = this[j];  this[j] = temp; }; Array.prototype.bubbleSort = function () {  for (var i = this.length - 1; i > 0; --i) {   for (var j = 0; j < i; ++j) {    if (this[j] > this[j + 1]) {     this.swap(j, j + 1);    }   }  } }; Array.prototype.selectionSort = function () {  for (var i = 0; i < this.length; ++i) {   var index = i;   for (var j = i + 1; j < this.length; ++j) {    if (this[j] < this[index]) {     index = j;    }   }   this.swap(i, index);  } }; Array.prototype.insertionSort = function () {  for (var i = 1; i < this.length; ++i) {   var j = i, value = this[i];   while (j > 0 && this[j - 1] > value) {    this[j] = this[j - 1];    --j;   }   this[j] = value;  } }; Array.prototype.shellSort = function () {  for (var step = this.length >> 1; step > 0; step >>= 1) {   for (var i = 0; i < step; ++i) {    for (var j = i + step; j < this.length; j += step) {     var k = j, value = this[j];     while (k >= step && this[k - step] > value) {      this[k] = this[k - step];      k -= step;     }     this[k] = value;    }   }  } }; Array.prototype.quickSort = function (s, e) {  if (s == null) {   s = 0;  }  if (e == null) {   e = this.length - 1;  }  if (s >= e) {   return;  }  this.swap((s + e) >> 1, e);  var index = s - 1;  for (var i = s; i <= e; ++i) {   if (this[i] <= this[e]) {    this.swap(i, ++index);   }  }  this.quickSort(s, index - 1);  this.quickSort(index + 1, e); }; Array.prototype.stackQuickSort = function () {  var stack = [0, this.length - 1];  while (stack.length > 0) {   var e = stack.pop(), s = stack.pop();   if (s >= e) {    continue;   }   this.swap((s + e) >> 1, e);   var index = s - 1;   for (var i = s; i <= e; ++i) {    if (this[i] <= this[e]) {     this.swap(i, ++index);    }   }   stack.push(s, index - 1, index + 1, e);  } }; Array.prototype.mergeSort = function (s, e, b) {  if (s == null) {   s = 0;  }  if (e == null) {   e = this.length - 1;  }  if (b == null) {   b = new Array(this.length);  }  if (s >= e) {   return;  }  var m = (s + e) >> 1;  this.mergeSort(s, m, b);  this.mergeSort(m + 1, e, b);  for (var i = s, j = s, k = m + 1; i <= e; ++i) {   b[i] = this[(k > e || j <= m && this[j] < this[k]) ? j++ : k++];  }  for (var i = s; i <= e; ++i) {   this[i] = b[i];  } }; Array.prototype.heapSort = function () {  for (var i = 1; i < this.length; ++i) {   for (var j = i, k = (j - 1) >> 1; k >= 0; j = k, k = (k - 1) >> 1) {    if (this[k] >= this[j]) {     break;    }    this.swap(j, k);   }  }  for (var i = this.length - 1; i > 0; --i) {   this.swap(0, i);   for (var j = 0, k = (j + 1) << 1; k <= i; j = k, k = (k + 1) << 1) {    if (k == i || this[k] < this[k - 1]) {     --k;    }    if (this[k] <= this[j]) {     break;    }    this.swap(j, k);   }  } }; Array.prototype.containKey = function(key) {  for (var i=0; i<this.length; i++) {   if (this[i] == key) {    return true;   }  }  return false; }; String.prototype.startsWith = function(prefix) {  return this.substring(0, prefix.length) == prefix; }; String.prototype.endsWith = function(suffix) {  return this.substring(this.length - suffix.length) == suffix; }; String.prototype.replaceAll = function(oldstr, newstr) {  return this.replace(new RegExp(oldstr,"gm"), newstr); };   return {  getHandler:function () {   var params = new Array();   for (var i = 0; i < arguments.length; i++) {    params[i] = arguments[i];   }   var scope = params.shift();   var func = params.shift();      return (function() {    if (func && typeof func == "function") {     func.apply(scope, params);    }    if (func && typeof func == "string") {     var handler = function() {       try {        eval(func);       } catch(ex) {      }     };     handler.apply(scope, params);     handler=null;    }    scope=null;params=null;   });  },    isArray:function (obj) {   return (typeof obj == 'object') && obj.constructor == Array;   },  isString:function (str) {   return (typeof str == 'string') && str.constructor == String;  },  isNumber:function (obj) {   return (typeof obj == 'number') && obj.constructor == Number;  },  isDate:function(obj) {   return (typeof obj == 'object') && obj.constructor == Date;  },  isFunction:function(obj) {   return (typeof obj == 'function') && obj.constructor == Function;  },  isObject:function(obj) {   return (typeof obj == 'object') && obj.constructor == Object;  },  startsWith:function(str1, str2) {   return str1.startsWith(str2);  },  trim:function(str) {   return (typeof str =="string" && str!="")?str.trim():"";  },  trimEmpty:function(param) {   return param == null ? null : param.replace(/ /g, "");  },   unicode:function(str){   var uni = 0;   if(typeof(str)=="string" && str!=""){   for (var i = 0; i < str.length; i++) {    uni += str.charCodeAt(i) / 6553.5 * Math.pow(10, str.length - i);   }}   return uni;  },   getLength:function(str) {   var length = 0;   if(typeof(str)=="string" && str!=""){   for (var i=0; i<str.length; i++) {    if (str.charCodeAt(i) > 255) length += 2; else length ++;   }}   return length;  },   getStrByPadPrefix:function (len, max) {   if (max == null) max = 4;    var str = "";   if(typeof(len)=="number" && len>-1){    str=len.toString();    for (var i=0; i<max - len.toString().length; i++) {     str = "0" + str;    }   }   return str;  },  getStrByPadLength:function (value, encode) {      if(typeof(value)!="string" || value=="") return "0000";   var length = encode != null && encode == true ? getLength(value) : value.length;   return Wade.util.getStrByPadPrefix(length) + value;  },  getArrayByEncodeStr:function(encodename, encodestr) {   var celllen = parseInt(encodestr.substring(0, 4), 10);   var rowlen = parseInt(encodestr.substring(4, 8), 10);   var content = encodestr.substring(8);     var namelen,value,array = new Array();   for (var i=0; i<rowlen; i++) {    array[i] = new Array();    for (var j=0; j<encodename.length; j++) {     namelen = parseInt(content.substring(0, 4), 10);     content = content.substring(4);          value = content.substring(0, namelen);     content = content.substring(namelen);          array[i][encodename[j]] = value;    }   }   celllen=null;rowlen=null;content=null;   return array;  },    getDateFromFormat:function(dateString,formatString){   if(typeof(dateString)=="string" && dateString!="")    return dateString.toDate(formatString);   return new Date();  },     getPartStr:function (str, maxlen) {   if(typeof(str)!="string" || str=="") return "";   if (Wade.util.getLength(str) <= maxlen) return str;   maxlen = maxlen - 3;   var partlen = 0;   var length = 0;   while (length < maxlen) {    if (str.charCodeAt(length) > 255) {     length += 2;    } else {     length ++;    }    partlen ++;   }   return str.substr(0, partlen) + "...";  },     containKey : function(array, key) {   for (var i=0; i<array.length; i++) {    if (array[i].value == key) {     return true;    }   }   return false;  },  getOS:function() {   var osstr = navigator.appVersion.split(";")[2].trim().toLowerCase();   switch (osstr) {    case "windows nt 5.0":     return "win2000";    case "windows nt 5.1":     return "winxp";    case "windows nt 5.2":     return "win2003";   }   return null;  },  getRandomParam:function(){   var date = new Date();   return "" + date.getYear() + (date.getMonth() + 1) + date.getDate() + date.getHours() + date.getMinutes() + date.getSeconds() + date.getMilliseconds();  },  setRandomParam:function(str){   if(typeof(str)=="string" && str!=""){    if (str.indexOf("&%72andom=") == -1 || str.indexOf("random=") == -1) str += "&random=" + Wade.util.getRandomParam();   }return str;  },    getParameter:function (param) {   var paramstr = window.location.search;   var len = param.length;   var start = paramstr.indexOf(param);   if (start == -1) return "";   start += len + 1;   var end = paramstr.indexOf("&", start);   if (end == -1) return decodeURIComponent(paramstr.substring(start));   return decodeURIComponent(paramstr.substring(start, end));  },  getReqParamByName:function (strurl, name) {   var len = name.length;   var start = strurl.indexOf(name);   if (start == -1) return "";   start += len + 1;   var end = strurl.indexOf("&", start);   if (end == -1) return decodeURIComponent(strurl.substring(start));   return decodeURIComponent(strurl.substring(start, end));  },  getReduceUrl:function (url) {   if (url && url!='' && url.indexOf("?") != -1) {    url = url.substr(url.indexOf("?") + 1);   }   return url;  },  toChineseMoney:function (money) {   if (money == null) return null;   money = new String(money);   for (var i=money.length-1; i>=0; i--) {    money = money.replace(",", "");    money = money.replace(" ", "");    }   money = money.replace("\uFFE5", "");   if (isNaN(money)) {    alert("\u8BF7\u68C0\u67E5\u5C0F\u5199\u91D1\u989D\u662F\u5426\u6B63\u786E");    return;   }   var prefix = money.startsWith("-") ? "\u8D1F" : "";   money = money.replace("-", "");   var part = money.split(".");   var newchar = "",perchar="";   var tmpnewchar = "";   for (var i=part[0].length-1; i>=0; i--) {    if (part[0].length > 10){     alert("\u4F4D\u6570\u8FC7\u5927\uFF0C\u65E0\u6CD5\u8BA1\u7B97");     return;    }    tmpnewchar = "";perchar = part[0].charAt(i);    switch (perchar) {        case "0": tmpnewchar = "\u96F6" + tmpnewchar; break;        case "1": tmpnewchar = "\u58F9" + tmpnewchar; break;        case "2": tmpnewchar = "\u8D30" + tmpnewchar; break;        case "3": tmpnewchar = "\u53C1" + tmpnewchar; break;        case "4": tmpnewchar = "\u8086" + tmpnewchar; break;        case "5": tmpnewchar = "\u4F0D" + tmpnewchar; break;        case "6": tmpnewchar = "\u9646" + tmpnewchar; break;        case "7": tmpnewchar = "\u67D2" + tmpnewchar; break;        case "8": tmpnewchar = "\u634C" + tmpnewchar; break;        case "9": tmpnewchar = "\u7396" + tmpnewchar; break;     }    switch (part[0].length - i - 1) {        case 0: tmpnewchar = tmpnewchar + "\u5143"; break;        case 1: if (perchar != 0) tmpnewchar = tmpnewchar + "\u62FE"; break;        case 2: if (perchar != 0) tmpnewchar = tmpnewchar + "\u4F70"; break;        case 3: if (perchar != 0) tmpnewchar = tmpnewchar + "\u4EDF"; break;        case 4: tmpnewchar = tmpnewchar + "\u4E07"; break;        case 5: if (perchar != 0) tmpnewchar = tmpnewchar + "\u62FE"; break;     case 6: if (perchar != 0) tmpnewchar = tmpnewchar + "\u4F70"; break;     case 7: if (perchar != 0) tmpnewchar = tmpnewchar + "\u4EDF"; break;     case 8: tmpnewchar = tmpnewchar + "\u4EBF"; break;     case 9: tmpnewchar = tmpnewchar + "\u62FE"; break;    }    newchar = tmpnewchar + newchar;   }   if (money.indexOf(".") != -1) {    if (part[1].length > 2) {     alert("\u5C0F\u6570\u70B9\u4E4B\u540E\u53EA\u80FD\u4FDD\u7559\u4E24\u4F4D\u002C\u7CFB\u7EDF\u5C06\u81EA\u52A8\u622A\u65AD");     part[1] = part[1].substr(0, 2);    }    tmpnewchar = "";perchar="";    for (var i=0; i<part[1].length; i++) {     tmpnewchar = "";perchar = part[1].charAt(i);     switch (perchar) {         case "0": tmpnewchar = "\u96F6" + tmpnewchar; break;         case "1": tmpnewchar = "\u58F9" + tmpnewchar; break;         case "2": tmpnewchar = "\u8D30" + tmpnewchar; break;         case "3": tmpnewchar = "\u53C1" + tmpnewchar; break;         case "4": tmpnewchar = "\u8086" + tmpnewchar; break;         case "5": tmpnewchar = "\u4F0D" + tmpnewchar; break;         case "6": tmpnewchar = "\u9646" + tmpnewchar; break;         case "7": tmpnewchar = "\u67D2" + tmpnewchar; break;         case "8": tmpnewchar = "\u634C" + tmpnewchar; break;         case "9": tmpnewchar = "\u7396" + tmpnewchar; break;     }     if (i == 0) tmpnewchar = tmpnewchar + "\u89D2";      if (i == 1) {      tmpnewchar = (part[1].charAt(0) == "0" ? "\u96F6" : "") + tmpnewchar + "\u5206";     }     newchar = newchar + tmpnewchar;    }       }   tmpnewchar=null;perchar=null;   while (newchar.search("\u96F6\u96F6") != -1) newchar = newchar.replace("\u96F6\u96F6", "\u96F6");   newchar = newchar.replace("\u96F6\u4EBF", "\u4EBF");   newchar = newchar.replace("\u4EBF\u4E07", "\u4EBF");   newchar = newchar.replace("\u96F6\u4E07", "\u4E07");   if (!newchar.startsWith("\u96F6\u5143")) newchar = newchar.replace("\u96F6\u5143", "\u5143");   newchar = newchar.replace("\u96F6\u89D2", "");   newchar = newchar.replace("\u96F6\u5206", "");   if (newchar.charAt(newchar.length - 1) == "\u5143" || newchar.charAt(newchar.length - 1) == "\u89D2")    newchar = newchar + "\u6574";   return prefix + newchar;  },  getPsptDate:function(str){   var d=null;   if(typeof(str)=="string" && str!=""){    var reg=/^\d{6}(19|20)?([0-9]{2})(0[1-9]|11|12)(0[1-9]|[1-2][0-9]|3[0-1])\d{3}[0-9Xx]$/i;    if(reg.test(str)){     str=str.replace(reg,'$1$2-$3-$4');     reg=/^[0-9]{2}-(0[1-9]|11|12)-(0[1-9]|[1-2][0-9]|3[0-1])$/;     if(str.length==8 && reg.test(str)){str="19"+str;}     d=str.toDate("yyyy-MM-dd");    }    reg=null;   }   str=null;   return d;  },  encodePasswd:function(str){   var chars = ["!","@","#","$","%","^","&","*","(",")"];   var len = str.length;   var rs = "";    for (var i=0; i<len; i++) {    var k = str.substring(i, i+1);     rs += "&#" + str.charCodeAt(i) + ";";     for (var j=0; j<4; j++) {     rs += chars[Math.floor(Math.random() * 10)];    }   }   return rs;  }     };})(); Wade.pub(Wade.util);Wade.dom=(function(){ var util=Wade.util; if(System.UserAgent.gecko){  window.constructor.prototype.showModalDialog = function(url, arg, parameters){   parameters = "width=" + arg.width + ",innerHeight=" + (parseInt(arg.height) + 30) + ",toolbar=no,menubar=no,scrollbars=no,location=no,resizable=no,alwaysRaised=yes,depended=yes";   var hasUrlParam = url.indexOf("?") == -1;   for (a in arg) {    url += (hasUrlParam ? "?" : "&") + a + "=" + encodeURIComponent(arg[a]);    if (hasUrlParam) hasUrlParam = false;   }   this.open(url, null, parameters);  };   if(window.HTMLElement){    HTMLElement.prototype.__defineGetter__("children", function() {          var tmp = [];          var j = 0;          var n;          for (var i=0; i<this.childNodes.length; i++) {              n = this.childNodes[i];              if (n.nodeType == 1) {                  tmp[j++] = n;                  if (n.name) {                      if(!tmp[n.name])        tmp[n.name] = [];                       tmp[n.name][tmp[n.name].length] = n;       }      if (n.id)       tmp[n.id] = n;                  }    }j=null;n=null;    return tmp;    });   HTMLElement.prototype.__defineGetter__("innerText", function() {   return this.textContent;    });  HTMLElement.prototype.__defineSetter__("innerText", function(sText) {   this.textContent=sText;   });     HTMLElement.prototype.__defineGetter__("parameters", function() {         return this.getAttribute("parameters");         });  HTMLElement.prototype.__defineGetter__("outerHTML",function() {          var a=this.attributes, str="<"+this.tagName, i=0;         for(;i<a.length;i++){           if(a[i].specified)               str+=" "+a[i].name+'="'+a[i].value+'"';          }a=null;                 if(!this.canHaveChildren)              return str+" />";          return str+">"+this.innerHTML+"</"+this.tagName+">";       });      HTMLElement.prototype.__defineSetter__("outerHTML",function(s) {          var r = this.ownerDocument.createRange();          r.setStartBefore(this);          var df = r.createContextualFragment(s);          this.parentNode.replaceChild(df, this);          df=null;r=null;         return s;       });      HTMLElement.prototype.__defineGetter__("canHaveChildren",function() {      var b,reg=/^(area|base|basefont|col|frame|hr|img|br|input|isindex|link|meta|param)$/;      b=!reg.test(this.tagName.toLowerCase());         reg=null;return  b;      });   }      };  var formDataElementTags=['input','select','textarea'];    var formElementSerializers = {   input: function(element) {     switch (element.type.toLowerCase()) {       case 'checkbox':       case 'radio':         return this.inputSelector(element);       default:         return this.textarea(element);     }   },   inputSelector: function(element) {     return element.checked ? element.value : null;   },   textarea: function(element) {     return element.value;   },   select: function(element) {     return this[element.type == 'select-one' ?       'selectOne' : 'selectMany'](element);   },   selectOne: function(element) {     var index = element.selectedIndex;     return index >= 0 ? this.optionValue(element.options[index]) : null;   },   selectMany: function(element) {     var values, length = element.length;     if (!length) return null;      for (var i = 0, values = []; i < length; i++) {       var opt = element.options[i];       if (opt.selected) values.push(this.optionValue(opt));     }     return values;   },   optionValue: function(opt) {     var opv=opt.getAttribute('value');     return opv!=null ? opt.value : opt.text;   } };  var formElementValueSetter = {   input: function(element,v) {     switch (element.type.toLowerCase()) {       case 'checkbox':       case 'radio':         return this.inputSelector(element,v);       default:         return this.textarea(element,v);     }   },   inputSelector: function(element,v) {     if(!element.value || element.value!=v){element.value=v;}     else if(element.value==v){element.checked=true;}   },   textarea: function(element,v) {     element.value=v;   },   select: function(element,v) {     return this[element.type == 'select-one' ?       'selectOne' : 'selectMany'](element,v);   },   selectOne: function(element,v) {     for(var i=0;i<element.options.length;i++){      if(this.optionValue(element.options[i])==v){       element.options[i].selected=true;      }     }   },   selectMany: function(element,v) {     var values, length = element.length;     if (!length) return null;      for (var i = 0, values = []; i < length; i++) {       var opt = element.options[i];       if (opt.selected) values.push(this.optionValue(opt));     }     return values;   },   optionValue: function(opt) {     var opv=opt.getAttribute('value');     return opv!=null ? opt.value : opt.text;   } };   var currentSortCellCursor=-1; function convertCompareDataType(sValue,sDataType){  switch(sDataType){   case "int":return parseInt(sValue);   case "float": return parseFloat(sValue);   case "date":return sValue.toString();   default:return sValue.toString();  } };  function generateCompareTRs(iCol,sDataType){  return function compareTRs(oTR1,oTR2){   var vValue1=oTR1.cells[iCol].innerHTML;   vValue1=vValue1.replace(/<\/?.+?>/g,"").trim();   vValue1=convertCompareDataType(vValue1,sDataType);   var vValue2=oTR2.cells[iCol].innerHTML;   vValue2=vValue2.replace(/<\/?.+?>/g,"").trim();   vValue2=convertCompareDataType(vValue2,sDataType);   if(typeof(vValue1)=="string" && typeof(vValue2)=="string"){    return vValue1.localeCompare(vValue2);   }else if(vValue1<vValue2){    return -1;   }else if(vValue1>vValue2){    return 1;   }else{    return 0;   }  }; };  var lastActiveElementID; return {  getElement:function(name) {   return document.getElementById(name);  },   getElementValue:function(name) {   var v;var element = document.getElementById(name);   v=(element && element.nodeType)? element.value:null;   element=null;return v;  },   getFormElementValue:function(tagName,element){   if(typeof(formElementSerializers[tagName])=="function")    return formElementSerializers[tagName](element);   return null;  },  setFormElementValue:function(tagName,element,value){   if(typeof(formElementValueSetter[tagName])=="function")    formElementValueSetter[tagName](element,value);  },  getElementBySrc:function() {   var srcElement = window.event == null ? null : window.event.srcElement;   if (srcElement != null) {    var srceleattr = srcElement.getAttribute("srcelement");    if (srceleattr != null && srceleattr == "parent") srcElement = srcElement.parentNode;    srceleattr=null;   }   return srcElement;  },  getElementByTag:function(obj, tag) {   while (obj != null && typeof(obj.tagName) != null) {    if (obj.tagName == tag.toUpperCase()) return obj;    obj = obj.parentNode;   }   return null;  },    getChildElement:function(obj, tag, sign) {   if (typeof(obj) == "string") {    obj = document.getElementById(obj);   }   if(obj && obj.nodeType      &&typeof(tag)=="string" && tag!=""      && typeof(sign)=="string" && sign!=""){    obj=dh.DomQuery.select('#' + dh.id(obj) + ' ' + tag.toLowerCase() + '[sign=' + sign +']');     if(obj && obj.length){ return obj[0];}   }   return null;  },  getParentElement:function(obj,tag,attr,value,dep){   if (typeof(obj) == "string") {    obj = document.getElementById(obj);   }   if(obj && obj.nodeType){    tag=typeof(tag)=="string" && tag!=""?tag:"*";    attr=typeof(attr)=="string" && attr!=""?("[" + attr + ((typeof(value)=="string" && value!="")?"=" + value:"")  +"]"):"";    return dh.findParent(obj,tag + attr,dep);   }   return null;     },  getElements:function(name) {   return document.getElementsByName(name);  },    getAttributeValue:function(obj, attrname, defvalue){   var attrvalue = obj == null ? null : obj.getAttribute(attrname);   return attrvalue == null ? defvalue : attrvalue;  },  getChildsByRecursion:function(object,tag,attr,value){   var r=[];if (typeof(object) == "string") {    object = document.getElementById(object);   }   if(object && object.nodeType){    tag=typeof(tag)=="string" && tag!=""?tag:"*";    attr=typeof(attr)=="string" && attr!=""?("[" + attr + ((typeof(value)=="string" && value!="")?"=" + value:"")  +"]"):"";    r=dh.DomQuery.select('#' + dh.id(object) + " " + tag + attr);   }   return r;  },  getParentForm:function(obj){   var f,o=System.fly(obj);   if(o && o.dom){    f=o.up('form');   }o=null;   return f;   },   addClass:function(el, className) {   var ele=System.fly(el);   if(ele){ele.addClass(className);}   ele=null;  },  removeClass:function (el, className) {   var ele=System.fly(el);   if(ele){ele.removeClass(className);}   ele=null;  },    setClass:function(name, value) {   var dd=document.getElementById(name);   if(dd)dd.className = value;dd=null;  },  hidden:function(obj, ishidden) {   if (typeof(obj) == "string") {    obj = document.getElementById(obj);   }   if(obj && obj.nodeType) {    obj.style.display = ishidden ? "none" : "";    var ctrlName = obj.getAttribute("ctrlName");    if (ctrlName != null) {     var ctrlObj,ctrlNames = trim(ctrlName).split(",");     for(var i=0; i<ctrlNames.length; i++) {      if (ctrlNames[i] != null && ctrlNames[i] != "") {       ctrlObj = document.getElementById(trim(ctrlNames[i]));       if (ctrlObj != null) {        ctrlObj.style.display = ishidden ? "none" : "";       }      }     }ctrlNames=null;ctrlObj=null;    }ctrlName=null;   }  },  disabledEditor:function(editorid,isdisabled){   if(!editorid){return;}   if(System.component.EditorManager){    if(isdisabled){     System.component.EditorManager.disableEditor(editorid);    }else{      System.component.EditorManager.enableEditor(editorid);          }   }  },    disabled:function(obj, isdisabled) {   if (typeof(obj) == "string") {    obj = document.getElementById(obj);   }   if(obj && obj.nodeType) {    obj.disabled = isdisabled;    var ctrlName = obj.getAttribute("ctrlName");    if (ctrlName != null) {     var ctrlObj,ctrlNames = trim(ctrlName).split(",");     for(var i=0; i<ctrlNames.length; i++) {      if (ctrlNames[i] != null && ctrlNames[i] != "") {       ctrlObj = Wade.dom.getElement(trim(ctrlNames[i]));       if (ctrlObj != null) {        if (isFormElement(ctrlObj)) ctrlObj.disabled = isdisabled;        else ctrlObj.style.display = isdisabled ? "none" : "";       }      }     }ctrlNames=null;ctrlObj=null;    }ctrlName=null;   }  },   focus:function(field) {   if(typeof(field)=="string" && field!=""){field=document.getElementById(field);}   try{if(field && field.nodeType){field.focus();}}catch(e){}field=null;  },  unfocusActiveInputElement:function(){   var el;try{el=document.activeElement;}catch(ex){}   if(el && el.nodeType){     var tagname=el.tagName.toUpperCase();    var type=el.getAttribute("type");    if((tagname=="INPUT" && type && type.toUpperCase()=="TEXT" )|| tagname=="TEXTAREA" || tagname=="SELECT"){    if(System.UserAgent.gecko){     el.blur();    }else{     lastActiveElementID=dh.id(el);     this.disabled(lastActiveElementID,true);     setTimeout(function(){Wade.dom.disabled(lastActiveElementID,false);},10);    }}tagname=null;type=null;   }  },  mouseOver:function(obj) {   obj.bgColor = "#F0F0F0";  },  mouseOut:function(obj) {   obj.bgColor = "#FFFFFF";  },     selectedAll : function(selectName) {   var options = document.getElementById(selectName);   for (var i=0; i<options.length; i++) {    options[i].selected = true;   }options=null;  },  checkedAll:function(boxName, ischecked) {   var boxList = Wade.dom.getElements(boxName);   for (var i=0; i<boxList.length; i++) {    if (boxList[i].disabled || boxList[i].getAttribute("flag") == "temp") continue;    boxList[i].checked = ischecked;   }boxList=null;  },    checkedOther:function (boxName) {   var boxList = Wade.dom.getElements(boxName);   for (var i=0; i<boxList.length; i++) {    if (boxList[i].disabled || boxList[i].getAttribute("flag") == "temp") continue;    boxList[i].checked = !boxList[i].checked;    }boxList=null;  },     getBoxNum:function(boxName) {   var l;var boxList = Wade.dom.getElements(boxName);   l=(boxList == null ? 0 : boxList.length);boxList=null;return l;  },  getCheckedBoxNum:function(boxName) {   var boxCount=0,boxList = Wade.dom.getElements(boxName);   for (var i=0; i<boxList.length; i++) {    if(boxList[i].checked) boxCount++;   }boxList=null;   return boxCount;  },  getCheckedBoxStr:function (boxName, separator) {   if(!(typeof(separator)=="string" && separator!="")) separator = ",";   var boxStr="",boxList = Wade.dom.getElements(boxName);   if(boxList && boxList.length){    for (var i=0; i<boxList.length; i++) {     if(boxList[i].checked) {      boxStr += (boxStr == "" ? "" : separator) + boxList[i].value;     }    }   }boxList=null;separator=null;   return boxStr;  },    getPageHeight:function() {   return dh.getViewWidth(true);  },  getDefaultSubmit:function () {   if (getPageVisit().defaultSubmit != 'true') return;   var forms = document.forms;   var f=false,elements,element;   for (var i=0; i<forms.length; i++) {    elements=forms[i].elements;    for (var j=0; j<elements.length; j++) {     element = elements[j];     if (element.tagName == "INPUT" && element.type.toUpperCase() == "SUBMIT"){      if (!element.disabled && element.style.display != "none") {       f=true;break;      }     }     element=null;    }    if(f==true)break;   }f=null;elements=null;forms=null;   return element;  },  fixHeight:function (box) {   try {    if (window != parent) {     var frms = parent.document.getElementsByTagName('FRAME');     var viewHeight,contentHeight,h;     for (var i = 0, l = frms.length; i < l; i++) {      if (frms[i].contentWindow == window) {       contentHeight=600;       viewHeight = frms[i].offsetHeight;       if (document.documentElement && document.documentElement.scrollHeight) {        contentHeight = document.documentElement.scrollHeight;       }              h = contentHeight - viewHeight;       if (h > 0) {        box.style.height = (box.offsetHeight - h) + 'px';        Wade.page.redisplay();       }       break;      }     }viewHeight=null;contentHeight=null;h=null;frms=null;    }   } catch (ex) {}  },  getAbsolutePos:function(el) {   var p,d=System.fly(el);   if(d){p=d.getXY();}d=null;   return p;  },  showGround:function(obj) {   if (!obj || !obj.currentStyle || !(obj.currentStyle.position == 'absolute' || obj.currentStyle.position == 'relative')) return;   var ground = obj.background;   if (!ground) {    ground = document.createElement("<iframe src='about:blank' style='position:absolute; left:0px; top:0px; width:0px; height:0px; display:none' scrolling='no' frameborder='0'></iframe>");    document.body.insertAdjacentElement("beforeEnd", ground);    obj.background = ground;   }   var pos = this.getAbsolutePos(obj);   with(ground.style) {    left = pos[0];    top = pos[1];    width = obj.offsetWidth + "px";    height = obj.offsetHeight + "px";    zIndex = "9998";    display = 'block';   }   obj.style.zIndex = "9999";   pos=null;ground=null;  },  hideGround:function(obj) {   var ground = obj.background;   if (!ground) return;   ground.parentNode.removeChild(ground);   obj.background = null;ground=null;  },  alterRelative:function() {   var allElement = document.getElementsByTagName('div');   for (var i = 0; i < allElement.length; i++) {    if (allElement[i].currentStyle.position == "relative") {     allElement[i].getAttribute("_position") = "relative";     allElement[i].runtimeStyle.position = "static";    }   }allElement=null;  },  resumeRelative:function() {   var allElement = document.getElementsByTagName('div');   for (var i = 0; i < allElement.length; i++){    if (allElement[i].getAttribute("_position") == "relative") {     allElement[i].runtimeStyle.position = "";     allElement[i].setAttribute("_position", null);    }   }allElement=null;  },  fillFormElementsValues:function(objs,form){   if(typeof(objs)=="object"){    if(!form){if(document.forms.length){form=document.forms[0];}else{return;}}    else{if(typeof(form)=="string"){form=document.getElementById(form);}if(!form || !form.nodeType) return;}    var formID=dh.id(form),data=new Wade.DataMap();    if((objs instanceof Array) && objs.length>0 && objs.length%2==0){     for(var i=0;i<objs.length;i+=2){data.add(objs[i],objs[i+1]);}    }else if(objs instanceof Wade.DataMap){data=objs;}    else{for(var p in objs){if(typeof(objs[p])!="function")data.add(p,objs[p]);}}    if(data.length){     var ipts;data.eachKey(function(key){      ipts=dh.DomQuery.select('#' + formID + ' *[name=' + key + ']');      if(ipts && ipts.length){       for(var i=0;i<ipts.length;i++){        if(ipts[i] && ipts[i].nodeType && formElementValueSetter[ipts[i].tagName.toLowerCase()]){         formElementValueSetter[ipts[i].tagName.toLowerCase()](ipts[i],data.get(key));        }       }      }     });ipts=null;    }data=null;   }  },  sortTable:function(sTable,iCol,sDataType){   var oTable=(sTable && sTable.nodeType && sTable.tagName=="TABLE")?sTable:document.getElementById(sTable);   if(!oTable)return false;   var oTbody=oTable.tBodies[0],colDataRows=oTbody.rows,aTRs=new Array;   var oThead=oTable.tHead,oH,loH;   oThead=oThead?oThead.rows[0]:null;   if(oThead){    if(!(currentSortCellCursor<0) && currentSortCellCursor!=iCol){     loH=oThead.cells[currentSortCellCursor];if(loH && loH.nodeType){loH=loH.firstChild;}     if(!loH || !loH.nodeType || !loH.tagName || !loH.tagName.toUpperCase()=="SAPN"){loH=null;}}     if(loH && loH.nodeType){loH.className="";}    }oH=oThead.cells[iCol];if(oH && oH.nodeType){oH=oH.firstChild;}    if(!oH || !oH.nodeType || !oH.tagName || !oH.tagName.toUpperCase()=="SAPN"){oH=null;}    if(oH){currentSortCellCursor=iCol;if(oH.className=="" || oH.className=="orderDown"){     oH.className="orderUp";}else{oH.className="orderDown";}   }loH=null;oH=null;tHead=null;oThead=null;   for(var i=0;i<colDataRows.length;i++){aTRs.push(colDataRows[i]);}   if(oTable.sortCol==iCol){aTRs.reverse();   }else{ aTRs.sort(generateCompareTRs(iCol,sDataType));}   var oFragment=document.createDocumentFragment();   for(var i=0;i<aTRs.length;i++){     aTRs[i].className=i % 2 == 0 ? "" : "odd";    oFragment.appendChild(aTRs[i]);   }oTbody.appendChild(oFragment);    oFragment=null;oTbody=null;colDataRows=null;aTRs=null;   oTable.sortCol=iCol;oTable=null;  },  isFormElement:function(obj) {   if(obj.nodeType == 3)obj = obj.parentNode;   return " button textarea input select option ".indexOf(" " + obj.tagName.toLowerCase() + " ") >= 0;  },  toBreakWord:function(obj,intLen){   if(typeof(obj)=="string" && obj!="")obj=document.getElementById(obj);   if(!obj || !obj.nodeType)return;   var strContent=obj.innerHTML;     var strTemp="";   while(strContent.length>intLen){    strTemp+=strContent.substr(0,intLen)+"&#10;";      strContent=strContent.substr(intLen,strContent.length);     }   strTemp+="&#10;"+strContent;   obj.innerHTML=strTemp;  },  copyToClipboard:function(txt) {          if(window.clipboardData) {               window.clipboardData.clearData();               window.clipboardData.setData("Text", txt);          } else if(navigator.userAgent.indexOf("Opera") != -1) {               window.location = txt;          } else if (window.netscape) {               try {                    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");               }catch (e){                    alert("\u88AB\u6D4F\u89C8\u5668\u62D2\u7EDD\uFF01\n\u8BF7\u68C0\u67E5\u6D4F\u89C8\u5668\u8BBE\u7F6E'signed.applets.codebase_principal_support'");                   return;            }               var clip = Components.classes['@mozilla.org/widget/clipboard;1'].createInstance(Components.interfaces.nsIClipboard);               if (!clip)                    return;               var trans = Components.classes['@mozilla.org/widget/transferable;1'].createInstance(Components.interfaces.nsITransferable);               if (!trans)                    return;               trans.addDataFlavor('text/unicode');               var str = new Object();               var len = new Object();               var str = Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);               var copytext = txt;               str.data = copytext;               trans.setTransferData("text/unicode",str,copytext.length*2);               var clipid = Components.interfaces.nsIClipboard;               if (!clip)                    return false;               clip.setData(trans,null,clipid.kGlobalClipboard);               }         alert("\u590D\u5236\u6210\u529F\uFF01");    }             }; })();Wade.pub(Wade.dom);Wade.event=(function(){ var util=Wade.util; var dom=Wade.dom;  if(System.UserAgent.gecko){  window.constructor.prototype.__defineGetter__("event", function() {   return Wade.event.searchEvent();  });   if (window.Event) {   Event.prototype.__defineSetter__("returnValue", function(b) {    if (!b) this.preventDefault();    return b;   });                  Event.prototype.__defineGetter__("srcElement", function() {          var node = this.target;          while (node && node.nodeType != 1) node = node.parentNode;    return node;   });      Event.prototype.__defineGetter__("keyCode", function() {    return this.charCode;   });  }   } var wade_keypress_events={}; var enterEventButtonID; return {  HotKeyTargets:null,  clearEnterEventButton:function(){   enterEventButtonID=null;  },  searchEvent:function(){   var func =Wade.event.searchEvent.caller;   var i=0,e;   while (func != null) {    var arg = func.arguments[0];    if (arg){     if(String(arg.constructor).indexOf('Event') > -1) {e=arg;break;}     if (arg instanceof System.Event.EventObjectImpl){e=arg.browserEvent;break;}    }    func = func.caller;    i++;    if(i>8)break;   }func=null;i=null;   return e;  },    stopEvent:function(ev) {   ev=ev || window.event;   if (ev.preventDefault && ev.stopPropagation) {    ev.preventDefault();    ev.stopPropagation();   } else {    ev.cancelBubble = true;    ev.returnValue = false;   }   return false;  },  fireMouseEvent:function (obj,event){    if(typeof(obj)=="string" && obj!="")obj=document.getElementById(obj);     if(!obj || !obj.nodeType){obj=null; return;}     if(System.UserAgent.ie){     try{eval("obj." + event + "();");}catch(e){}       if(window.event){window.event.returnValue = false;   window.event.cancelBubble = true; }     }else if(System.UserAgent.gecko){        var e = document.createEvent('MouseEvents');        e.initEvent(event,true,true);        obj.dispatchEvent(e);        e.stopPropagation();   e.preventDefault();    }    },    fireTargetObjMouseEvent:function(target,obj,event){   if(target && Wade.page.isSameDomain(target)){    var flowtab=target.document.getElementById("flowtab");    if(flowtab){     var w=flowtab.contentWindow;     if(w.Wade && w.pageflow){      var acstep,activetab = w.Wade.dom.getElement(w.pageflow.selectedTabName);      if(activetab) {       acstep=activetab.parentNode.id;       var currstepframe=w.parent.document.getElementById(acstep);       currstepframe=currstepframe?currstepframe.contentWindow:null;       if(currstepframe){        if(currstepframe.Wade){         currstepframe.Wade.event.fireMouseEvent(obj,event);        }else{}       }currstepframe=null;      }acstep=null;activetab=null;     }w=null;     }else{     if(target.Wade){      target.Wade.event.fireMouseEvent(obj,event);     }else{Wade.event.fireMouseEvent(obj,event);}    }flowtab=null;       }  },  setHotkey:function(targets) {   this.HotKeyTargets=targets;    },    setKeyPressEvent:function(fldname, btname) {   wade_keypress_events[fldname] = btname;  },  removeKeyPressEvent:function(fldname){   if(typeof(fldname)=="string" && fldname!=""){    delete wade_keypress_events[fldname];   }  },  onDocumentKeyDownEvent:function(e){   var keyCode = e.keyCode;   var srcelement=e.target;   if(keyCode==8 || keyCode==32){    if(srcelement && srcelement.nodeType && srcelement.tagName     && (srcelement.tagName.toUpperCase()=="INPUT" || srcelement.tagName.toUpperCase()=="TEXTAREA")){     return true;    }else{     e.stopEvent();    }   }   var targets=Wade.event.HotKeyTargets;   if (!targets) return;   if(typeof(targets)=="string" && targets!="")targets=targets.split(",");   if(!targets || !targets.length)return;   var pm=(e.ctrlKey && (keyCode==67 || keyCode== 86 || keyCode==88));   if (keyCode == 112) {    window["onhelp"]=function() { return false; }   }else if(keyCode==9){    return true;   }else if(System.UserAgent.ie && !pm){    try{e.browserEvent.keyCode=0;}catch(ex){}   }       var hotkey,target;   for(var i=0;i<targets.length;i++){    target = eval(targets[i]);    if(target){hotkey = target.document.getElementById("HOTKEY_" + keyCode);if(hotkey)break;}    hotkey=null;   }   if (hotkey && hotkey.nodeType && !pm){    if(target.Wade){     target.Wade.event.fireMouseEvent(hotkey,"click");    }else{hotkey.click();}     e.stopEvent();           }    },  onDocumentKeyPressEvent:function(e){   if (e.keyCode == 13){    var evtbutton = null;    var srcelement = e.target;    if (srcelement && srcelement.nodeType){     if(((srcelement.tagName.toUpperCase() == "INPUT" &&       (srcelement.type.toUpperCase() == "TEXT" || srcelement.type.toUpperCase() == "BUTTON"))      || srcelement.tagName.toUpperCase()=="BUTTON")      && !srcelement.disabled && !srcelement.readOnly) {       var evtbtname = wade_keypress_events[dh.id(srcelement)];      if (evtbtname != null){       evtbutton = document.getElementById(evtbtname);       if(evtbutton && evtbutton.nodeType){enterEventButtonID=null;}      }evtbtname=null;     }else if(srcelement.tagName.toUpperCase() == "TEXTAREA") {      return false;     }    }srcelement=null;    var btn=Wade.context.getButton();        if(evtbutton == null && typeof(btn)=="string" && btn!= "") {     evtbutton = dom.getElement(btn);    }btn=null;    var smbt=false;    if(evtbutton == null){     evtbutton = dom.getDefaultSubmit();smbt=1;    }    var asyncError=typeof(Wade.excedesc)!="undefined" && Wade.excedesc.AsyncError;    var fpError=typeof(Wade.excedesc)!="undefined" && Wade.excedesc.HiddenFramePostError;    if(evtbutton && evtbutton.nodeType){if(smbt===1)smbt=true;     var btnID=dh.id(evtbutton),hasBtnID=(typeof(enterEventButtonID)=="string" && enterEventButtonID!="");     if((!hasBtnID || (((asyncError ||fpError) && !smbt) || btnID!=enterEventButtonID)) &&       !Wade.page.isPageLoading() && (((asyncError||fpError) && !smbt) || !Wade.page.isPageOverlay()) && !Wade.dialog.hasOpendDialog()){      enterEventButtonID=btnID;      Wade.event.fireMouseEvent(evtbutton,"click");     }btnID=null;     evtbutton=null;    }fpError=null;asyncError=null;smbt=null;    e.stopEvent();return false;   }  },   onDocumentMouseDown:function(e){   if(System.isReady){    var srcelement=e.target;    if(srcelement && srcelement.nodeType && srcelement.tagName && !srcelement.disabled      && srcelement.tagName.toUpperCase()=="A" && srcelement.getAttribute("name")=="wade_contextmenu_item"){                   }    }   return true;  },   onDocumentContextmenuEvent:function(e){   if(System.isReady){    var srcelement=e.target;    if(srcelement && srcelement.nodeType && srcelement.tagName && !srcelement.disabled      && (srcelement.tagName.toUpperCase()=="INPUT" || srcelement.tagName.toUpperCase()=="TEXTAREA")){          return true;    }    }   e.stopEvent();  },  onSbtframeReadyStateChange:function(e){   var submited=this.getAttribute("submited");   submited=(typeof(submited)=="string" && submited=="true");   if(submited && this.readyState=="loading"){    this.setAttribute("afterloading","true");   }submited=null;  },  addObjEventListener:function(obj, eventName, eventHandler) {   if(typeof(obj)=="string"){    var str=obj;obj=document.getElementById(obj);    if(!obj || !obj.nodeType)eval("obj=" + str);str=null;   }   if(typeof(eventHandler)=='string')eval('eventHandler=' + eventHandler);   if(obj && obj.nodeType){System.EventManager.on(obj,eventName,eventHandler);}obj=null;  },  removeObjEventListener:function(obj, eventName, eventHandler) {   if(typeof(obj)=="string"){    var str=obj;obj=document.getElementById(obj);    if(!obj || !obj.nodeType)eval("obj=" + str);str=null;   }   if(typeof(eventHandler)=='string')eval('eventHandler=' + eventHandler);   if(obj && obj.nodeType){System.EventManager.un(obj,eventName,eventHandler);}obj=null;  }    };})();Wade.pub(Wade.event);Wade.contextMenu=(function(){ var dh=System.DomHelper;  var menuShadow; return {  copy:function(){   if(System.UserAgent.ie){    document.execCommand("Copy", false, true);   }  },  paste:function(){   if(System.UserAgent.ie){    Wade.dom.focus("sortText");    document.execCommand("Paste", false, true);   }  },  cut:function(){   if(System.UserAgent.ie){    document.execCommand("Cut", false, true);   }  },  hide:function(){   var ctm=document.getElementById("wade_contextmenu");   if(ctm){    if(menuShadow){     menuShadow.hide();    }    ctm.style.display="none";   }ctm=null;     },  show:function(xy){   if(System.UserAgent.ie){    var ctm=document.getElementById("wade_contextmenu");    if(!ctm){     ctm=dh.insertHtml("beforeend",document.body,'<div id="wade_contextmenu" class="c_edge" style="width:40px;position:absolute;z-index:99;">'+     '<div class="l_padding"><div class="list"><ul>'+      '<li><a class="text" name="wade_contextmenu_item" href="javascript:void(0);" onclick="javascript:Wade.contextMenu.copy();">¸´ÖÆ</a></li>'+     '<li><a class="text" name="wade_contextmenu_item" href="javascript:void(0);" >Õ³Ìù</a></li>'+     '<li><a class="text" name="wade_contextmenu_item" href="javascript:void(0);" onclick="javascript:Wade.contextMenu.cut();">¼ôÇÐ</a></li>'+     '<li><a class="text" name="wade_contextmenu_item" href="javascript:void(0);" onclick="javascript:alert("dd")" >¹Ø±Õ</a></li>'+     '</ul></div></div></div>');    }        if(!menuShadow){     menuShadow=new System.UI.Shadow({               mode : "drop",               offset : 2           });    }        ctm.style.display="";        if(xy){     dh.setXY(ctm,xy);    }    menuShadow.show(ctm);    ctm=null;   }  } }})();Wade.context=(function(){ var dom=Wade.dom;  var _pageVisit=null; var _pageContext=null;  function getPageVisit(){  if(_pageVisit==null || _pageContext==null){   _pageVisit=dom.getElement("pagecontext");   _pageContext={};   if(_pageVisit && _pageVisit.nodeType){    _pageContext['contextName']=_pageVisit.getAttribute("contextName");    if(!_pageContext['contextName']){_pageContext['contextName']="app";}    _pageContext['pageName']=_pageVisit.getAttribute("pagename");        _pageContext['staffId']=_pageVisit.getAttribute("staffId");        _pageContext['staffName']=_pageVisit.getAttribute("staffName");        _pageContext['subSysCode']=_pageVisit.getAttribute("subSysCode");        _pageContext['epachyId']=_pageVisit.getAttribute("loginEpachyId");    if(!_pageContext['epachyId']){_pageContext['epachyId']=_pageVisit.getAttribute("epachyId");}        _pageContext['epachyName']=_pageVisit.getAttribute("epachyName");    _pageContext['deptId']=_pageVisit.getAttribute("deptId");    _pageContext['deptCode']=_pageVisit.getAttribute("deptCode");    _pageContext['deptName']=_pageVisit.getAttribute("deptName");    _pageContext['cityId']=_pageVisit.getAttribute("cityId");    _pageContext['cityName']=_pageVisit.getAttribute("cityName");    _pageContext['loginEpachyId']=_pageVisit.getAttribute("loginEpachyId");    _pageContext['productMode']=(_pageVisit.getAttribute("productMode")=="true");    _pageContext['provinceId']=_pageVisit.getAttribute("provinceId");    _pageContext['version']=_pageVisit.getAttribute("version");    _pageContext['hotkey']=_pageVisit.getAttribute("hotkey");    _pageContext['initScript']=_pageVisit.getAttribute("initScript");    _pageContext['button']=_pageVisit.getAttribute("button");    _pageContext['relativelyDir']=_pageVisit.getAttribute("relativelyDir");    _pageContext['defaultSubmit']=_pageVisit.getAttribute("defaultSubmit");    _pageContext['randomCode']=_pageVisit.getAttribute("randomCode");    if(!_pageContext['relativelyDir']){_pageContext['relativelyDir']="";}   }  }  window["pagevisit"]=_pageVisit;  return _pageVisit;   }  function getEventSourceSubSysInfo(obj,_ss,_ssc,_ssa){  var r={subsys:_ss,subsyscode:_ssc,subsysaddr:_ssa};  if(typeof(obj)=="string" && obj!="")obj=document.getElementById(obj);  obj = obj && obj.nodeType?obj: dom.getElementBySrc();  if(obj && obj.nodeType){   if(typeof(r.subsys)!="string" || r.subsys=="")r.subsys=(typeof(obj.subsys)!="undefined" && obj.subsys)?obj.subsys:obj.getAttribute("subsys");   if(typeof(r.subsyscode)!="string" || r.subsyscode=="")r.subsyscode=(typeof(obj.subsyscode)!="undefined" && obj.subsyscode)?obj.subsyscode:obj.getAttribute("subsyscode");   if(typeof(r.subsysaddr)!="string" || r.subsysaddr=="")r.subsysaddr =(typeof(obj.subsysaddr)!="undefined" && obj.subsysaddr)?obj.subsysaddr: obj.getAttribute("subsysaddr");    }obj=null;  if(typeof(r.subsys)=="undefined" || r.subsys=="")r.subsys=null;  if(typeof(r.subsyscode)=="undefined" || r.subsyscode=="")r.subsyscode=null;  if(typeof(r.subsysaddr)=="undefined" || r.subsysaddr=="")r.subsysaddr=null;  if (typeof(r.subsysaddr)=="string" &&  r.subsysaddr!=""){   if(!r.subsysaddr.endsWith("/")) {    r.subsyscontextname = r.subsysaddr.substring(r.subsysaddr.lastIndexOf("/") + 1);    r.subsysaddr = r.subsysaddr.substring(0, r.subsysaddr.lastIndexOf("/") + 1);   }  }     return r; }  function buildContextName(o,notFromForm){  if(!_pageVisit || !_pageContext){getPageVisit();}  var r,o=o?o:getEventSourceSubSysInfo();  if(o){   if(o.subsys){r=_pageContext.contextName;}   else if(o.subsyscontextname){ r=o.subsyscontextname;}  }o=null;     if(!r && !notFromForm){for (var i=0; i<document.forms.length; i++) {    var action = document.forms[i].action;    if (action && typeof(action)== "string") {     r=action.substr(action.lastIndexOf("/") + 1);     if(r.indexOf("?")>-1)r=r.substring(0,r.lastIndexOf("?"));     break;         }  }}     if(!r){r=_pageContext.contextName;}  return r;   }  function buildSysAddr(url, subsyscode, subsysaddr){  if(!_pageVisit || !_pageContext){getPageVisit();}  var addr="";if(typeof(subsysaddr)=="string" && subsysaddr!=""){addr+=subsysaddr;}  addr+=url;var subSysCode = subsyscode ? subsyscode : _pageContext.subSysCode;  if (_pageContext.staffId && addr.indexOf("&%73taffId=") == -1) addr += "&staffId=" + _pageContext.staffId;  if (subSysCode && addr.indexOf("&%73ubSysCode=") == -1) addr += "&subSysCode=" + subSysCode;  if (_pageContext.epachyId && addr.indexOf("&%65parchyCode=") == -1) addr += "&eparchyCode=" + _pageContext.epachyId;  subSysCode=null;  return addr;   }  function buildPageUrl(page, listener, params,israw){  if(!_pageVisit || !_pageContext){getPageVisit();}  if (page == null || (page != null && typeof(page) != "string")){ page = _pageContext.pageName;}  var o=getEventSourceSubSysInfo();  var url =buildContextName(o) + "?service=page/" + page;   if (listener != null && listener!="") url += "&listener=" + listener;  if (params != null && params!="") url +="&"+ System.Common.parseUrlParams(params);  if (israw == null || !israw)url = buildSysAddr(url, o.subsyscode, o.subsysaddr);  o=null;return url; }  function buildAsyncUrl(page, listener, params, partids, israw){  if(!_pageVisit || !_pageContext){getPageVisit();}  if (page == null || (page != null && typeof(page) != "string")){ page = _pageContext.pageName;}  if(!(typeof(partids)=="string" && partids!=""))partids="";  var o=getEventSourceSubSysInfo();  var url = buildContextName(o,true) + "?service=ajaxDirect/1/" + page + '/' + page + '/javascript/' + partids;  if (page != null && page!='') url += "&pagename=" + page;  if (listener != null && listener!='') url += "&eventname=" + listener;  if (params != null && params!='') url += '&' + System.Common.parseUrlParams(params);  if (israw == null || !israw) url = buildSysAddr(url, o.subsyscode, o.subsysaddr);  o=null;url = url + "&partids=" + partids;  return url; } return {  unInit:function(){   delete _pageVisit;_pageVisit=null;   delete _pageContext;_pageContext=null;  },  getPageVisit:function(){   if(!_pageContext)getPageVisit();   return _pageContext;  },  getSysAddr:function(url, subsyscode, subsysaddr) {   return buildSysAddr(url, subsyscode, subsysaddr);  },  getSubSysInfo:function(obj,subsys,subsyscode,subsysaddr){   return getEventSourceSubSysInfo(obj,subsys,subsyscode,subsysaddr);  },  getContextName:function(o,notFromForm) {   return buildContextName(o,notFromForm);  },  hasPriv:function(privcode) {   if(!_pageContext)getPageVisit();   if (_pageContext.staffId == "SUPERUSR") return true;    return (_pageVisit.getAttribute(privcode) != null && _pageVisit.getAttribute(privcode) != '');  },  getVersion:function() {   if(!_pageContext)getPageVisit();   return _pageContext.version;  },  getPageName:function() {   if(!_pageContext)getPageVisit();   return _pageContext.pageName;  },   getHotKey:function(){   if(!_pageContext)getPageVisit();   return _pageContext.hotkey;  },   getInitScript:function(){   if(!_pageContext)getPageVisit();   return _pageContext.initScript;  },   getButton:function(){   if(!_pageContext)getPageVisit();   return _pageContext.button;  },  getRelativelyDir:function(){   if(!_pageContext)getPageVisit();   return _pageContext.relativelyDir;  },  isProv:function(provinceId) {   if(!_pageContext)getPageVisit();   return (_pageContext.provinceId == provinceId);  },    isProductMode:function(){   if(!_pageContext)getPageVisit();   return _pageContext.productMode;  },  getPageUrl:function(page, listener, params,israw) {   return buildPageUrl(page, listener, params,israw);  },  getAsyncUrl:function(page, listener, params, partids, israw){   return buildAsyncUrl(page, listener, params, partids, israw);  }      };})();Wade.pub(Wade.context);Wade.nav=(function(){ var util=Wade.util; var dom=Wade.dom; var evt=Wade.event;  return {  getFrame:function(frame) {   var target = null,flowframe=false;   if (util.isString(frame)) {    var array = frame.split(".");    for (var i=0; i<array.length; i++) {     if (array[i] == "parent") {      target = target == null ? parent : target.parent;     }    }array=null;    if(frame=="flowtab" || frame=="flowsubmit"){flowframe=true;}    if (target != null) return target;   }      var tgtrange = flowframe?this.getActiveNavFrame():(Wade.page.isSameDomain(top)?window.top:parent);   if (util.isArray(frame)) {    tgtrange = frame[1];    frame = frame[0];   }   var f=false,jfrms,kfrms,ifrms = tgtrange.frames;   for (var i=0; i<ifrms.length; i++) {    jfrms = ifrms[i].frames;    try{if (jfrms.name == frame){target=jfrms;break;}}catch(ex){}    if (jfrms.length > 0) {     for (var j=0; j<jfrms.length; j++) {      kfrms = jfrms[j].frames;      try{if(kfrms.name == frame) {target=kfrms;f=true;break;}}catch(ex){}      if (kfrms.length > 0) {       for (var k=0; k<kfrms.length; k++) {        if (kfrms[k].name == frame){target=kfrms[k];f=true;break;}       }      }      if(f==true){break;}     }    }if(f==true){break;}   }tgtrange=null;f=null;ifrms=null;jfrms=null;kfrms=null;   return target;  },  getFrameByLoop:function(frame) {   var frm = Wade.nav.getFrame(frame);   if (frm != null) return frm;   return setTimeout("Wade.nav.getFrameByLoop(" + frame + ")", 200);  },  getNavFrame:function(target, menuidx) {   var navframe = target.frames["navframe_" + menuidx];   if (navframe != null && navframe.location.href == "about:blank" && target.menuframe.document.getElementById(navframe.name + "_close") == null) {    return navframe;   }navframe=null;   var frame;for(var i=0; i<target.frames.length; i++) {    frame = target.frames[i];    try{     if(!frame.name.startsWith("navframe_")) continue;     if(frame.location.href == "about:blank" && target.menuframe.document.getElementById(frame.name + "_close") == null) break;    }catch(ex){continue;}   }   return frame;  },    addNavFrame:function(target, url, title, insmode, hold) {   if (insmode == null) insmode = "beforeend";   if (!hold || (typeof(hold) == "string" && hold != "true")) hold="false";else hold = "true";   var sdu=Wade.page.isSameDomainUrl(url);   if (target == "contentframe"){    target = this.getFrame("contentframe");    if(target == null) target = top;   }   if (target.menuframe == null) return false;   var navmenuidx = target.menuframe.Wade.navMenu.NAV_MENU_CURSOR ++;   var navframe = this.getNavFrame(target, navmenuidx);   var navmenus = target.menuframe.document.getElementById("navmenus");   var mn=navmenus.childNodes.length;   if (navframe == null || mn>9) {    alert("\u6253\u5F00\u9875\u9762\u6570\u5DF2\u8D85\u8FC7\u6700\u5927\u9650\u5236\uFF0C\u8BF7\u5148\u5173\u95ED\u90E8\u5206\u9875\u9762\u540E\u518D\u64CD\u4F5C\uFF01");    return true;   }      var targetsrc = util.getReduceUrl(url);   var menu,mli,frameid,frame,framesrc,fl=false;   for(var i=0; i<mn; i++) {    menu = navmenus.childNodes[i];    frameid = menu.getAttribute("relaframe");    frame = target.frames[frameid];    try{framesrc=frame.location.href}catch(ex){framesrc=frame.src;}    framesrc = util.getReduceUrl(framesrc);    mli=target.menuframe.document.getElementById(frameid + "_loading");    if (mli && (title==mli.getAttribute("title") || framesrc == targetsrc)) {     Wade.nav.switchNavFrame(target, menu.id);     mli.className = "li loading";     frame.location.href = url;     fl=true;break;    }   }menu=null;mli=null;frameid=null;frame=null;framesrc=null;targetsrc=null;   if(fl==true){hold=null;target=null;navframe=null;navmenus=null;fl=null;return true;}      var lock = ((hold == "true") || (target.menuframe.Wade.navMenu.HOLD_FIRST_PAGE && target.menuframe.Wade.navMenu.NAV_MENU_CURSOR == 1));   if (lock) hold = "true";      var navmenuid = "navmenu_" + navmenuidx;   var navframeid = navframe.name;   var closeNavMethod = "closeOnEsc", searchKeyWord = "&closeNavMethod=";   if (url.indexOf(searchKeyWord) != -1) {    closeNavMethod = url.substring(url.indexOf(searchKeyWord) + searchKeyWord.length);    if (closeNavMethod.indexOf("&") != -1) closeNavMethod = closeNavMethod.substring(0, closeNavMethod.indexOf("&"));   }searchKeyWord=null;   var htmlArry=new Array();   htmlArry.push('<li id="' + navmenuid + '" class="on" hold="' + hold + '" relaframe="' +  navframeid + '">');   htmlArry.push('<a href="javascript:void(0)" id="' + navframeid + '_loading" class="li' + (sdu?'  loading':'')+'" title="' + title + '" ');   htmlArry.push(' onfocus="javascript:this.blur();" onclick="javascript:Wade.nav.switchNavFrame(parent, \'' + navmenuid + '\');" ');      if(!lock)       htmlArry.push(' ondblclick="javascript:return Wade.nav.closeNavFrame(parent, \'' + navmenuid + '\',\'' + closeNavMethod + '\');" ');      htmlArry.push('><span class="left"></span><span class="text">');   htmlArry.push('<span>' + util.getPartStr(title, 20) + '</span>');   htmlArry.push('</span><span class="right"></span></a>');      if (!lock) {       htmlArry.push('<a id="' + navframeid + '_close" href="javascript:void(0)" class="closeTab" ');    htmlArry.push('onfocus="javascript:this.blur();" ');       htmlArry.push('onclick="javascript:return Wade.nav.closeNavFrame(parent, \'' + navmenuid + '\', \'' + closeNavMethod + '\');" ');       htmlArry.push('></a>');      }        htmlArry.push('</li>');lock=null;hold=null;   dh.insertHtml(insmode,navmenus,htmlArry.join(""));   htmlArry=null;closeNavMethod=null;navframeid=null;   this.switchNavFrame(target, navmenuid);target=null;navmenuid=null;   navframe.location.href = url;navframe=null;   return true;  },  switchNavFrame:function(target, navmenuid) {   var navframeset = target.document.getElementById("navframeset");   if (navframeset == null) return;   var menuframe=target.menuframe;if(!menuframe)return;      var navmenus = menuframe.document.getElementById("navmenus");   if (navmenus.childNodes.length == 0) {navframeset=null;navmenus=null;return;}   var navmenu = navmenuid == null ? navmenus.childNodes[0] : menuframe.document.getElementById(navmenuid);      var navframeid = navmenu.getAttribute("relaframe");   var navframeidx = navframeid.substring("navframe_".length);   var navarray = navframeset.cols.split(",");   var navcols = "";   for (var i=0; i<navarray.length; i++) {    navcols += (i == navframeidx) ? "*" : "0";    if (i != navarray.length - 1) navcols += ",";   }   menuframe.Wade.navMenu.ACTIV_NAVFRAME_IDX=navframeidx;   navframeidx=null;navarray=null;navframeid=null;   navframeset.cols = navcols;navframeset=null;navcols=null;     var navfoucs = false,menu;   for (var i=0; i<navmenus.childNodes.length; i++) {    menu = navmenus.childNodes[i];    if (!navfoucs && menu.id == navmenu.id) {     menu.className = "on";     navfoucs = true;    } else {     menu.className = "";    }   }navfoucs=null;menu=null;navmenus=null;menuframe=null;  },    closeNavFrame:function(target, navmenuid, closeNavMethod) {   var navmenu = target.menuframe.document.getElementById(navmenuid);   if (navmenu == null) return false;      if (target.menuframe.Wade.navMenu.HOLD_FIRST_PAGE && navmenuid.substring("navmenu_".length) == "0") {    alert("\u4E0D\u80FD\u5173\u95ED\u4E3B\u9875\u9762\uFF01");    navmenu=null;return false;   }   if (navmenu.getAttribute('hold') == 'true'){    alert("\u88ab\u9501\u5b9a\u9875\u4e0d\u80fd\u5173\u95ed");    navmenu=null;return false;   }      var prenavmenuid = null;   var navmenus = target.menuframe.document.getElementById("navmenus").childNodes;   for (var i=0; i<navmenus.length; i++) {    if (i > 0 && navmenus[i].id == navmenuid) {     prenavmenuid = navmenus[i - 1].id;     break;    }   }navmenus=null;      var navframeid = navmenu.getAttribute("relaframe");   var navframeidx = navframeid.substring("navframe_".length);   var navframe = target.frames[navframeid];   if (navframe == null){ navframeid=null;navframeidx=null;navmenu=null;return false;}      var closeMethodReturn;   if (typeof(closeNavMethod)=="string" && closeNavMethod!="") {    if(typeof(navframe[closeNavMethod])=="function"){     try {closeMethodReturn=navframe[closeNavMethod]();}catch (e){}    }   }closeNavMethod=null;   if(closeMethodReturn==false)return;   System.fly(navmenu).remove();navmenu=null;   Wade.nav.switchNavFrame(target, prenavmenuid);   navframe.location.href = "about:blank";navframe=null;   System.CG();   return true;  },  holdFirstNavFrame:function(target, ishold) {   var f;if(f=Wade.nav.getFrame(target))   f.menuframe.Wade.navMenu.HOLD_FIRST_PAGE = ishold;f=null;  },  getActiveNavMenu:function(target) {   var navframeset = target.document.getElementById("navframeset");   if (navframeset == null) return null;navframeset=null;      var navmenus = target.menuframe.document.getElementById("navmenus");   if (navmenus.childNodes.length == 0){ navmenus=null;return null;}      var menu=null;   for (var i=0; i<navmenus.childNodes.length; i++) {    menu=navmenus.childNodes[i];    if(menu.className == "on"){break;}   }navmenus=null;   return menu;  },   getActiveNavFrame:function(){   var nvf=null;   if(!Wade.page.isSameDomain(top))return nvf;   var ct=this.getFrame(["contentframe",top]);   if(ct){    var mf=this.getFrame(["menuframe",ct]);    if(mf && mf.Wade && mf.Wade.navMenu){     var id=mf.Wade.navMenu.ACTIV_NAVFRAME_IDX;     if(typeof(id)=="string" && /\d+/.test(id)){      nvf=ct.frames["navframe_" + id];      }id=null;    }mf=null;   }ct=null;return nvf;  },    getNavFrameByLocation:function() {   if (parent.document.getElementById("navframeset") != null) {    var targetsrc = util.getReduceUrl(location.href);    var frames = parent.frames;    var framesrc =null,frame=null;    for (var i=0; i<frames.length; i++) {     frame=frames[i];     try{framesrc = frame.location.href;}catch(ex){framesrc=frame.src;}     if(framesrc!=null && framesrc != "about:blank") {      framesrc = util.getReduceUrl(framesrc);      if (targetsrc == framesrc) {       break;      }     }framesrc=null;    }frames=null;targetsrc=null;return frame;   }   return null;  },    getNavFrameByTitle:function(title){   var nvf=null;   if(!Wade.page.isSameDomain(top))return nvf;   var ct=this.getFrame(["contentframe",top]);   if(ct){    var mf=this.getFrame(["menuframe",ct]);    if(mf && mf.Wade && mf.Wade.navMenu){     var navmenus=mf.document.getElementById("navmenus");     navmenus=mf.Wade.dom.getChildsByRecursion(navmenus,"a","title");        var mn=navmenus.length,navmenuid;     if(mn){      for(var i=0;i<mn;i++){       if(navmenus[i].getAttribute("title")==title){        navmenuid=navmenus[i].parentNode.id;        break;       }      }      if(navmenuid){       navmenuid=navmenuid.substring("navmenu_".length);       if(typeof(navmenuid)=="string" && /\d+/.test(navmenuid)){        nvf=ct.frames["navframe_" + navmenuid];        }      }     }mn=null;navmenuid=null;navmenus=null;        }mf=null;   }ct=null;return nvf;     },  closeNavFrameByLocation:function () {   var cW =top.window.document.getElementById("contentframe");   if(cW && cW.nodeType){    cW=cW.contentWindow;    var navmenu=cW.Wade.nav.getActiveNavMenu(cW);    if (navmenu && navmenu.nodeType) {     var navframeid = navmenu.getAttribute("relaframe");     if (navframeid != null) {      var tabclose = cW.menuframe.document.getElementById(navframeid + "_close");      if (tabclose != null) cW.Wade.event.fireMouseEvent(tabclose,"click");tabclose=null;     }    }navmenu=null;   }cW=null;  },  setNavTitle:function(title){   var navframe = Wade.nav.getNavFrameByLocation();   if (navframe && parent && parent.menuframe) {    var tabload = parent.menuframe.document.getElementById(navframe.name + "_loading");    if (tabload && title && typeof(title)=='string') {     tabload.childNodes[1].childNodes[0].innerHTML = title;    }tabload=null;   }navframe=null;     }       };})();Wade.pub(Wade.nav);Wade.page=(function(){ var dom=Wade.dom; var evt=Wade.evt; var nav=Wade.nav; var context=Wade.context;  function isSameDomain(target) {  var r=false;try{if(target && target.document){   r=(target.document.domain == document.domain);  }}catch(e){}  return r; }  function isSameDomainUrl(url){  if(!(typeof(url)=="string" && url!="")) return false;  var domainReg=/(http:\/\/)?([a-zA-Z0-9_:.]+)(\/.+|\?.+)?/i;  var loc=top.window.location.href;loc=loc.replace(domainReg,"$2");  var urlloc=url.replace(domainReg,"$2");  var r=(loc==urlloc || (/^[\/a-z]+$/i.test(urlloc) && urlloc!="localhost"));  domainReg=null;loc=null;urlloc=null;  return r;  } var pageLoading=false; var pageOverlay=false; return {  isSameDomain:function(target){   return isSameDomain(target);  },  isSameDomainUrl:function(url){   return isSameDomainUrl(url);  },  isPageLoading:function(){   return pageLoading;  },  isPageOverlay:function(){   return pageOverlay;  },  onPageLoad:function(){   if(isSameDomain(parent)) {    if (parent.document.getElementById("navframeset") != null) {     var navframe = nav.getNavFrameByLocation();     if (navframe != null) {      var d = parent.menuframe.document;      var tabload = d.getElementById(navframe.name + "_loading");      if (tabload != null) {       var hold = tabload.parentNode.getAttribute('hold');       tabload.className = "li " + (hold == "true" ? "locked" : "");hold=null;      }tabload=null;d=null;     }navframe=null;    } else if (parent.document.getElementById("flowbody") != null) {     if (self.name != "flowtab" && self.name != "flowsubmit" && self.name != "flowleft" && self.name != "flowright") {      nav.getFrame(["flowtab", parent]).pageflow.endFlowLoading();     }    } else {     if(parent.UserAgent && parent.Wade){ parent.Wade.page.endPageLoading();parent.Wade.event.clearEnterEventButton();}    }   }   if(isSameDomain(top)){    var cf=nav.getFrame("contentframe");    if(cf && cf.Wade){     if(context.getPageVisit().staffId!=null&&context.getPageVisit().staffId!=""&&cf.Wade.context.getPageVisit().staffId!=context.getPageVisit().staffId){      MessageBox.alert("\u9875\u9762\u5C06\u5173\u95ED",'<div style="text-align:left;width:220px;" class="x-errormsg">' +           '<div style="padding-left:42px;height:33px;">\u60A8\u5F53\u524D\u7684\u64CD\u4F5C\u8005\u4E3A\u524D\u4E00\u4E2A\u767B\u5F55\u5DE5\u53F7\uFF0C\u8BF7\u5173\u95ED\u5F53\u524D\u529F\u80FD\u540E\u91CD\u65B0\u6253\u5F00\u529F\u80FD\u4EE5\u91CD\u7F6E'+                  '</div></div>',function(){       Wade.ajax.ajaxDirect('component.Logout', null, null, null, null, function() {Wade.nav.closeNavFrameByLocation()});      });       return false;         }    }cf=null;   }   return true;  },  beginPageLoading:function (loading_type) {   if (loading_type == null) loading_type = "all";   var loading = dom.getElement("loading");   var overlay = dom.getElement("overlay");   var html;   if (loading_type == "all" || loading_type == "loading") {    if (loading == null) {     html='<div id="loading" class="c_loading" style="display:block">' +       '<span id="loading_txt">\u8F7D\u5165\u4E2D..<span>' +       '</div>';     dh.insertHtml('beforeend',document.body,html);    }   }   if (loading_type == "all" || loading_type == "overlay") {    if(overlay==null){     html='<div id="overlay" class="c_overLay">' +       '<iframe style="height:' +         dh.getViewHeight(true) + 'px;width:' + dh.getViewWidth(true) +       '" frameborder="no" scrolling="no"></iframe></div>';     dh.insertHtml('beforeend',document.body,html);    }   }loading=null;overlay=null;html=null;   pageLoading=true;  },   endPageLoading:function(loading_type) {   if (loading_type == null) loading_type = "all";   if (loading_type == "all" || loading_type == "loading") {    var loading = System.fly("loading");    if(loading){loading.remove();}loading=null;   }   if (loading_type == "all" || loading_type == "overlay") {    var overlay = System.fly("overlay");    if(overlay){overlay.remove();}overlay=null;   }     pageLoading=false;  },  isFlowPage:function(){   var r=false;   if(parent && isSameDomain(parent)){    var fb=parent.document.getElementById("flowbody");    if(fb && fb.nodeType){r=true}fb=null;   }   return r;  },  beginFlowOverlay:function(){   if(this.isFlowPage()){     var flowtabframe=nav.getFrame(["flowtab", parent]);    if(flowtabframe){     flowtabframe.pageflow.beginFlowOverlay();    }flowtabframe=null;   }   },  endFlowOverlay:function(){   if(this.isFlowPage()){    var flowtabframe=nav.getFrame(["flowtab", parent]);    if(flowtabframe){     flowtabframe.pageflow.endFlowOverlay();    }flowtabframe=null;    }     },  updateLoadingMsg:function(str){   if(typeof(str)=='string' && str!=''){    var lt=document.getElementById('loading_txt');    if(lt){lt.innerHTML=str;}lt=null;   }  },  removeLoadingMsg:function(){   var loading = dh.Element.get("loading");   if(loading){loading.remove();}loading=null;   },      submitLoading:function(){   Wade.page.beginPageLoading();  },  removeLoading:function() {   Wade.page.endPageLoading();  },  beginPageOverlay:function () {   var pagelay = dom.getElement("pagelay");   if(!pagelay){    var html='<div id="pagelay" class="c_overLay">' +       '<iframe style="height:' +         dh.getViewHeight(true) + 'px;width:' + dh.getViewWidth(true) +       '" frameborder="no" scrolling="no"></iframe></div>';    dh.insertHtml('beforeend',document.body,html);html=null;   }pagelay=null;   pageOverlay=true;  },  endPageOverlay:function () {   var pagelay = System.fly("pagelay");   if (pagelay) {pagelay.remove();}pagelay=null;   pageOverlay=false;  },    lockFormState:function(object){   var theForm = null;      if (typeof(object) == "object") {    if (object != null) theForm = object.form;   } else if (typeof(object) == "string") {    var areaobj = dom.getElement(object);    if (areaobj == null) {     alert(object + " not exist!");     return false;    }    theForm = areaobj.form;areaobj=null;   }      if (theForm == null) theForm = document.forms[0];   if (theForm.getAttribute("lock") == null || theForm.getAttribute("lock") == "false") {    theForm.setAttribute("lock", "true");    resetFormStateByTime();    Wade.validate.initialAll();   } else {    theForm=null;    alert("\u64CD\u4F5C\u5DF2\u63D0\u4EA4\uFF0C\u8BF7\u7A0D\u540E...");    return false;   }theForm=null;   return true;  },  resetFormState:function() {   for (var i=0; i<document.forms.length; i++) {    document.forms[i].setAttribute("lock", "false");   }  },  resetFormStateByTime:function() {   setTimeout('Wade.page.resetFormState();', 500);  },  execOnload:function(func) {   var f;   if(typeof(func)=='string'){    f=function(){try{eval(func)}catch(ex){}};   }else if(typeof(func)=='function'){    f=func   }if(f){System.onLoad(f);}  },  redisplay:function () {   if(document.body){    document.body.style.display = 'none';    document.body.style.display = '';   }  },   cancel:function(iswin) {   if(iswin!=null && iswin){    var Win;    if(typeof(window.parent)!='undefined' &&      typeof(window.parent.window)!='undefined'     && (Win=window.parent.window) && Win.Wade      && Win.Wade.dialog.hasOpendDialog()){           Win=window.parent.window;           Win.Wade.dialog.closeCurrentDialog();    }else{top.close();}Win=null;   }else{ history.back();}  },   clickTabPane:function (target, page, listener, params, isreload) {   var frame = dom.getElement(target);   if (frame && frame.src == null || frame.src == "" || isreload != null && isreload) {    var parameters = frame.getAttribute("parameters") + (params ? params : "");    Wade.redirect.redirectTo(page, listener, parameters, frame.name);   }frame=null;  },    linkSubmit:function(form, elementId) {   dom.getElement("wade_pagesubmit").value = elementId;   if (form.onsubmit == null || form.onsubmit()) form.submit();  },  pageSubmit:function(page, listener, params, target,israw) {   var form;   var obj=dom.getElementBySrc();   if(obj && obj.nodeType){    form=dom.getParentForm(obj);   }obj=null;    if(!form && document.forms.length){    form=document.forms[0];   }   if(form && form.nodeType){    if (page == null || (page != null && typeof(page) != "string")){ page = context.getPageName();}    var url=context.getPageUrl(page,listener,params,israw);    form.target="_self";form.action=url;    if (target) form.target = target;    form.submit();   }form=null;  },     completePageLoad:function() {}       };})();Wade.pub(Wade.page);Wade.redirect=(function(){ var util=Wade.util; var dom=Wade.dom; var context=Wade.context; var nav=Wade.nav; var page=Wade.page;  function redirectToNavByUrl(url, target, hold, eventTarget) {  var f=nav.getFrame(target);  if (f && f.location.href == "about:blank") {   target=(eventTarget?eventTarget:dom.getElementBySrc());   url = "&url=" + url;   var linkobj = dom.getElementByTag(target, "a");   if (linkobj != null && (typeof(linkobj.innerHTML)!="undefined" && linkobj.innerHTML!="")){     url = "&title=" + linkobj.innerHTML.replace(/<\/?[^>]*>/ig,"") + url;   }linkobj=null;        url=context.getPageUrl("component.Navigation","opencontent",null,true) + url;   f.location.href = url;  } else {   redirectToByUrl(url, target, null, hold);  }f=null;target=null; }  function redirectToByUrl(url, target, israw, hold, eventTarget) {  var obj = (eventTarget?eventTarget:dom.getElementBySrc());    if (target != null && target != "" && target != "contentframe" && target != "currentframe") {   var object = dom.getElement(target);   if(object && object.tagName == "IFRAME") {    if(System.isReady){Wade.page.beginPageLoading();}    if(System.UserAgent.ie){object.src = url;}else{object.contentWindow.location=url;}   }else {    object=nav.getFrame(target);    object.window.location.href = url;   }object=null;  } else {   var linkobj = obj == null ? null : dom.getElementByTag(obj, "a");   var caption = linkobj != null ? linkobj.getAttribute("caption") : (obj == null ? null : obj.getAttribute("caption"));   if (caption == null) {    if (linkobj != null) {     caption =(typeof(linkobj.innerHTML)!="undefined" && linkobj.innerHTML!="")?linkobj.innerHTML.replace(/<\/?[^>]*>/ig,""):null;    } else if (obj != null && obj.value != null) {     caption = obj.value;    }   }   if (caption != null) {    if (target != "currentframe") {     var insmode = obj == null ? null : obj.getAttribute("insmode");     if (nav.addNavFrame(target == null ? parent : target, url, caption, insmode, hold,eventTarget)) return;    }   }   if (linkobj != null) {    linkobj.href = url;   } else {    location.href = url;   }linkobj=null;caption=null;  }obj=null; } return {  redirectToNav:function(page, listener, params, target, hold) {   var url=context.getPageUrl(page,listener,params);   var c=false,b=false,e=window.event || event;   if(typeof(target)=="string" && target=="contentframe"    && Wade.page.isSameDomain(top)){    c=true;var cf = top.document.getElementById(target);    if(cf && cf.nodeType){     var doc=cf.contentWindow.document;     if(doc){      cf=doc.getElementById("menuframe");      if(cf && cf.nodeType){       doc=cf.contentWindow.document;       if(doc){doc=doc.getElementById("navmenus");       if(doc && doc.nodeType)b=true;}      }     }doc=null;    }cf=null;   }   if(target && !(c==true && b==false)){    var event_target=null;if(e){event_target=System.UserAgent.ie?e.srcElement:e.target;}    redirectToNavByUrl(url, target, hold, event_target);   }  },  redirectTo:function(page, listener, params, target, israw, hold) {   var url=context.getPageUrl(page, listener, params, israw);   redirectToByUrl(url, target, israw, hold);  },    redirectToNavByUrl:function(url, target, hold){   url = context.getSysAddr(url);   return redirectToNavByUrl(url, target, hold);  },  openmenu:function (url) {   if (!url) return false;   if (url.lastIndexOf("&url=") != -1) {    url = url.substr(url.lastIndexOf("&url=") + 5);   }   url = context.getSysAddr(url);   redirectToNavByUrl(url, "contentframe");  },  redirectToJsp:function(page, params, target) {   var url = "" + page;   if (params != null) url = url + "?" + params;     if (target != null && target != "") {    nav.getFrame(target).window.location.href = url;   } else {    var linkobj = dom.getElementByTag(dom.getElementBySrc(), "a");    if (linkobj != null) {     linkobj.href = url;    }else{     location.href = url;    }linkobj=null;   }  },  redirectToExtscrByUrl:function(url) {   var menuframe = nav.getFrame("menuframe");   if (menuframe == null) {    alert("\u672A\u68C0\u6D4B\u5230\u53CC\u5C4F\u63A7\u5236\u5F00\u5173\uFF01");    return;   }   var dboutwin = null, dboutdoc = null;   var dbctrlwin = menuframe.Wade.navMenu.getDbctrlWin();   if (dbctrlwin == null) {    alert("\u9700\u8981\u5148\u5F00\u542F\u53CC\u5C4F\u63A7\u5236\u9875\u9762\uFF0C\u786E\u8BA4\u5F00\u542F\u53CC\u5C4F\u63A7\u5236\u5417\uFF1F");    menuframe.Wade.navMenu.turnOnDbdisplay(url);    menuframe=null;return;   }menuframe=null;   try {    dboutwin = dbctrlwin.Wade.dbdisplay.dboutwin;    dboutdoc = dboutwin.document;   } catch (e) {   }dbctrlwin=null;dboutdoc=null;      if (dboutwin == null || dboutdoc == null) {    alert("\u8BF7\u5148\u5F00\u542F\u5916\u5C4F\u9875\u9762");    dboutwin=null;dboutdoc=null;return;   }   dboutwin.location.href = url;dboutwin=null;  },  redirectToExtscr:function(page, listener, params) {   var url=context.getPageUrl(page,listener,params);   url=util.setRandomParam(url);   this.redirectToExtscrByUrl(url);  }    };})();Wade.pub(Wade.redirect);Wade.dialog=(function(){ var util=Wade.util; var dom=Wade.dom; var evt=Wade.evt; var context=Wade.context; var page=Wade.page; var redirect=Wade.redirect;  var wadeDialog=null; var wadeDialogFrames=[]; var wadeDialogEventSourceObj=null; var wadeDialogReturnObj=null; var currentOpenFrameIndex=-1; var isPopupPage=false;  function openDialog(url, width, height, arg) {  return window.showModalDialog(url, arg, "dialogWidth: " + width + "px; dialogHeight: " + height + "px; resizable: no; help: no; status: no; scroll: no;"); }  function setWadeDialogEventSourceObj(eventSourceObj){  wadeDialogEventSourceObj=null;  if(eventSourceObj!=null && typeof(eventSourceObj)=="string" && eventSourceObj!=""){eventSourceObj=document.getElementById(eventSourceObj);}  if(eventSourceObj!=null && typeof(eventSourceObj)=="object" && eventSourceObj.nodeType){wadeDialogEventSourceObj=eventSourceObj;return;}  wadeDialogEventSourceObj=null; } function parseReturnValue(eventObj,returnValue){  if(!eventObj || !eventObj.nodeType) return false;  if(typeof(returnValue)=='undefined' || !returnValue) return false;  if(typeof(returnValue)=="object"){   var pageName = returnValue.$pageName;   if (pageName != null) {    redirect.redirectTo(pageName, returnValue.$listener, returnValue.$parameters, returnValue.$target);    pageName=null;return;   }  }  var fieldName = eventObj.getAttribute("fieldName");  var textName = eventObj.getAttribute("textName");  var afacScript="",isComponent=false;;  if((typeof(textName)=="string" && textName!="")&& ((typeof(fieldName)=="string" && fieldName!="")) &&    eventObj.parentNode && eventObj.parentNode.tagName=="TD" && eventObj.parentNode.parentNode && eventObj.parentNode.parentNode.tagName=="TR"){    var pIpt=System.fly(eventObj.parentNode.parentNode).child("input[name=" + textName + "]");    if(pIpt && pIpt.dom.id==pIpt.dom.getAttribute("name")){afacScript=pIpt.dom.getAttribute("afterAction");isComponent=true;}pIpt=null;  }if(!isComponent){afacScript=eventObj.getAttribute("afterAction");}    fieldName=document.getElementById(fieldName);  textName=document.getElementById(textName);  if(fieldName && fieldName.nodeType)fieldName.value=returnValue.value;  if(textName && textName.nodeType)textName.value=returnValue.text;  var paramNames = returnValue.paramNames;  var paramValues = returnValue.paramValues;  if(paramNames && paramNames.length && paramValues && paramValues.length) {   var field;for(var i=0; i<paramNames.length; i++) {    field = document.getElementById(paramNames[i]);    if (field && field.nodeType) field.value = paramValues[i];   }field=null;  }fieldName=null;textName=null;paramNames=null;paramValues=null;returnValue=null;  if(typeof(afacScript)=="string" && afacScript!=""){   try{(function(el){eval(afacScript)}).apply(window,[eventObj])}catch(ex){}  }afacScript=null;    }   function recoverDialogFrame(){  if(wadeDialog && currentOpenFrameIndex>=0){      var frame=null,rArry=[];   for(var i=0;i<wadeDialogFrames.length;i++){    if(wadeDialogFrames[i]=="recover"){     rArry.push(i);     frame=System.fly("wade_dlg_frames_" + i);     if(frame!==null){frame.remove();}    }    }frame=null;   for(var i=0;i<rArry.length;i++){    wadeDialogFrames.splice(rArry[i],1);   }   rArry=null;  } }   function enableDialogContent(url){  recoverDialogFrame();    if(typeof(url)!='string' || url=='') return;  var key,reg=/&refresh=(true|false|1|0)/ig,refresh=false,closeable=true;  var m=reg.exec(url);if(m && m.length>1){   m=m[1].toLowerCase();if(m=='true' || m==1 || m=='1'){refresh=true;}  }m=null;key=url.replace(reg,"");  reg=/&closeable=(true|false|1|0)/ig;  m=reg.exec(url);if(m && m.length>1){   m=m[1].toLowerCase();if(m=='false' || m==0 || m=='0'){closeable=false;}  }m=null;key=url.replace(reg,"");  reg=null;  var obj=null,found=false;    var cUrl=url+"&popupdialog_random_code="+Math.random();  if(!wadeDialog)Wade.dialog.init();  wadeDialog.close.enableDisplayMode("block");  if(closeable==false){wadeDialog.close.setVisible(false);}else{wadeDialog.close.setVisible(true);}  for(var i=0;i<wadeDialogFrames.length;i++){   obj=document.getElementById('wade_dlg_frames_' + i);   if(obj){    if(wadeDialogFrames[i]==key){     currentOpenFrameIndex=i;if(refresh){obj.src=cUrl;}     obj.style.display="";found=true;    }else{obj.style.display="none";}   }obj=null;  }  if(!found && wadeDialog.body){   currentOpenFrameIndex=wadeDialogFrames.length;   obj=wadeDialog.body.createChild({tag:"iframe",id: "wade_dlg_frames_" + currentOpenFrameIndex,name: "wade_dlg_frames_" + currentOpenFrameIndex,scrolling:"no",frameborder:"0",src:""});            obj.dom.contentWindow.location=cUrl;             obj.setWidth('100%');obj.setHeight('100%');obj.enableDisplayMode('block');obj.setVisible(true);obj=null;   wadeDialogFrames.push(key);  }found=null;key=null;cUrl=null;url=null; }  return {  init:function(){   if(!wadeDialog){    wadeDialog=new System.UI.Components.BasicDialog("wade_dlg", {      autoCreate:true,      shim:false,                  modal:true,                  shadow:false,                  resizable:false,                  draggable:true,                  proxyDrag:false,                  collapsible:false,                  fixedcenter:true,         constrain:false,         constraintoviewport:true,                  width:400,                  height:300,                  minWidth:400,                  minHeight:300                           });           wadeDialog.on("hide",this.dialogOnHidden,this);                               wadeDialog.refreshBtn = wadeDialog.toolbox.createChild({cls:"x-dlg-refresh"});          wadeDialog.refreshBtn.on("click", this.dialogOnRefreshButtonClick, this);          wadeDialog.refreshBtn.addClassOnOver("x-dlg-refresh-over");   }     },  unInit:function(){         wadeDialogFrames=[];delete wadeDialogFrames;wadeDialogFrames=null;   delete wadeDialogEventSourceObj;wadeDialogEventSourceObj=null;   delete wadeDialogReturnObj;wadeDialogReturnObj=null;   currentOpenFrameIndex=null;isPopupPage=null;     },   dialogOnHidden:function(){      if(Wade.page.isFlowPage()){    Wade.page.endFlowOverlay();   }   currentOpenFrameIndex=-1;if(wadeDialogEventSourceObj && wadeDialogReturnObj){       parseReturnValue(wadeDialogEventSourceObj,wadeDialogReturnObj);      }wadeDialogEventSourceObj=null;wadeDialogReturnObj=null;  },  dialogOnRefreshButtonClick:function(){   var dom=document.getElementById("wade_dlg_frames_" + currentOpenFrameIndex);         if(dom){          if(typeof(wadeDialogFrames[currentOpenFrameIndex])!='undefined'){           dom.src=wadeDialogFrames[currentOpenFrameIndex]+"&popupdialog_random_code="+Math.random();          }         }dom=null;   },  addBeforeShowEventListener:function(fn,scope){   if(wadeDialog && typeof(fn)=="function"){wadeDialog.on("beforeshow",fn,scope);}  },  removeBeforeShowEventListener:function(fn,scope){   if(wadeDialog){    if(typeof(fn)=="function"){wadeDialog.un("beforeshow",fn,scope);}    else if(typeof(wadeDialog.events["beforeshow"])=="object"){     wadeDialog.events["beforeshow"].clearListeners();    }   }  },  addBeforeHideEventListener:function(fn,scope){   if(wadeDialog && typeof(fn)=="function"){wadeDialog.on("beforehide",fn,scope);}  },  removeBeforeHideEventListener:function(fn,scope){   if(wadeDialog){    if(typeof(fn)=="function"){wadeDialog.un("beforehide",fn,scope);}    else if(typeof(wadeDialog.events["beforehide"])=="object"){     wadeDialog.events["beforehide"].clearListeners();    }   }  },  addOnShowEventListener:function(fn,scope){   if(wadeDialog && typeof(fn)=="function"){wadeDialog.on("show",fn,scope);}     },  removeOnShowEventListener:function(fn,scope){   if(wadeDialog){    if(typeof(fn)=="function"){wadeDialog.un("show",fn,scope);}    else if(typeof(wadeDialog.events["show"])=="object"){     wadeDialog.events["show"].clearListeners();    }   }     },  getCurrentOpenFrame:function(){   return wadeDialogFrames[currentOpenFrameIndex];  },  getCurrentOpenFrameName:function(){   return 'wade_dlg_frames_'  + currentOpenFrameIndex;  },  getDialogEventSourceObj:function(){   return wadeDialogEventSourceObj;  },  recoverCurrentOpenFrame:function(){   if(currentOpenFrameIndex>=0){    wadeDialogFrames[currentOpenFrameIndex]="recover";   }return true;  },  openDialog:function(url, width, height, arg){   return openDialog(url, width, height, arg);  },  hasOpendDialog:function(){   return (currentOpenFrameIndex>=0);  },  closeCurrentDialog:function(){   if(wadeDialog){wadeDialog.hide();}wadeDialogEventSourceObj=null;System.CG();  },   popupDialog:function (page, listener, params, title, width, height, subsyscode, subsysaddr,eventSourceObj) {   setWadeDialogEventSourceObj(eventSourceObj);   if(!wadeDialogEventSourceObj)wadeDialogEventSourceObj = dom.getElementBySrc();   if(wadeDialogEventSourceObj && wadeDialogEventSourceObj.nodeType && isPopupPage){    if(!subsyscode){subsyscode=wadeDialogEventSourceObj.getAttribute("subsyscode");}    if(!subsysaddr){subsysaddr=wadeDialogEventSourceObj.getAttribute("subsysaddr");}   }isPopupPage=false;   if (title == null) title = "\u5F39\u51FA\u7A97\u53E3";   if (width == null) width = 400;   if (height == null) height = 300;   if(typeof(width)=='string')try{width=parseInt(width);}catch(e){wdith=parseInt(dh.removeUnits(width));}    if(typeof(height)=='string')try{height=parseInt(height);}catch(e){height=parseInt(dh.removeUnits(height));}    width+=38;height+=38;   var vh=dh.getViewHeight(true),vw=dh.getViewWidth(true);   if(width>(vw-5))width=vw;if(height>(vh-5))height=vh;   var o=context.getSubSysInfo(wadeDialogEventSourceObj,null,subsyscode,subsysaddr);   var url = context.getContextName(o) + "?service=page/" + page;   if (listener != null) url += "&listener=" + listener;   if (params != null) url += params;   url = context.getSysAddr(url,o.subsyscode,o.subsysaddr);         enableDialogContent(url);   wadeDialog.setTitle(title);   wadeDialog.resizeTo(width,height);            if(Wade.page.isFlowPage()){    Wade.page.beginFlowOverlay();   }   wadeDialog.show();         var currentFrame=document.getElementById(this.getCurrentOpenFrameName());   if(currentFrame){    var win=currentFrame.contentWindow;    if(win && win["onDialogActive"] && typeof(win["onDialogActive"]=="function")){     win["onDialogActive"].apply(win,[]);    }win=null;   }currentFrame=null;   },  popupPage:function(page, listener, params, title, width, height,eventSourceObj){   isPopupPage=true;this.popupDialog(page, listener, params, title, width, height,null ,null ,eventSourceObj);  },   winPopupDialog:function (page, listener, params, title, width, height, subsyscode, subsysaddr) {   if (title == null) title = "\u5F39\u51FA\u7A97\u53E3";   if (width == null) width = 400;   if (height == null) height = 300;   if(typeof(width)=='string')try{width=parseInt(width);}catch(e){wdith=parseInt(dh.removeUnits(width));}    if(typeof(height)=='string')try{height=parseInt(height);}catch(e){height=parseInt(dh.removeUnits(height));}    if(util.getOS()=="winxp"){height+=25;}   var url = context.getContextName() + "?service=page/" + page;   if (listener != null) url += "&listener=" + listener;   if (params != null) url += params;   url = context.getSysAddr(url, subsyscode, subsysaddr);         var obj = new Object();   obj.title = title;   obj.width = width;   obj.height = height;   obj.url = url;   obj.parentwindow = window;   var returnValue = openDialog(context.getContextName() + "?service=page/component.Agent&random=" + Math.random(), width, height, obj);   if (returnValue != null) {    var pageName = returnValue.$pageName;    if (pageName != null) {     redirect.redirectTo(pageName, returnValue.$listener, returnValue.$parameters, returnValue.$target);    }   }   return returnValue;  },    winPopupPage:function(page, listener, params, title, width, height){   wadeDialogEventSourceObj = dom.getElementBySrc();   if (System.UserAgent.gecko) {    function popPageConfirm_Button_Click(){     parseReturnValue(imgobj,window.returnValue);     Wade.page.endPageOverlay();     var cf=dom.getElement('popPageConfirm');     if(cf && cf.nodeType){      cf.parentNode.removeChild(cf);     }cf=null;    }    var html='<div id="popPageConfirm" class="c_popup" style="border:solid 1px #b4b4b4;width:400px;height:120px;background-color:#e6e6e6;">' +       '<div style="padding:20px;">\u8BF7\u5728\u6253\u5F00\u7684\u5F39\u51FA\u7A97\u53E3\u8FDB\u884C\u76F8\u5173\u64CD\u4F5C\uFF0C\u5F85\u64CD\u4F5C\u5B8C\u6210\u5E76\u5173\u95ED\u5F39\u51FA\u7A97\u53E3\u540E\uFF0C\u70B9\u3010\u786E\u8BA4\u3011\u7EE7\u7EED\u8FDB\u884C\u540E\u7EED\u64CD\u4F5C\uFF01</div>' +          '<div style="text-align:center;"><input id="popPageConfirm_button" type="button" value="\u0020\u786E\u0020\u8BA4\u0020" /></div></div>';     Wade.page.beginPageOverlay();    dh.insertHtml('beforeend',document.body,html);html=null;    evt.addObjEventListener('popPageConfirm_button','click',popPageConfirm_Button_Click);       }      this.winPopupDialog(page, listener, params, title, width, height, wadeDialogEventSourceObj.getAttribute("subsyscode"), wadeDialogEventSourceObj.getAttribute("subsysaddr"));   if(System.UserAgent.ie){parseReturnValue(imgobj,returnValue);}     },  setDialogReturnObj:function(obj){   wadeDialogReturnObj=obj;  },    setReturnObj:function (obj){   var Win;   if(typeof(window.parent)!="undefined" &&     typeof(window.parent.window)!="undefined"    && (Win=window.parent.window) && Win.Wade     && Win.Wade.dialog.hasOpendDialog()){       Win=window.parent.window;              Win.Wade.dialog.setDialogReturnObj(obj);       Win.Wade.dialog.closeCurrentDialog();Win=null;   }else{       if (System.UserAgent.gecko) {     if(typeof(top.window.opener)!="undefined" && top.window.opener!=null){top.window.opener.returnValue = obj;}    } else {     window.returnValue = obj;    }    top.close();   }   },    setReturnValue:function (value, text, paramNames, paramValues) {   var obj = new Object();   obj.value = value;   obj.text = text;   obj.paramNames = paramNames;   obj.paramValues = paramValues;   setReturnObj(obj);  },  setReturnFunc:function(pageName, listener, parameters, target) {   var obj = new Object();   obj.$pageName = pageName;   obj.$listener = listener;   obj.$parameters = parameters;   obj.$target = target;   setReturnObj(obj);  } };})();Wade.pub(Wade.dialog);Wade.upload=(function(){ var util=Wade.util; var dom=Wade.dom; var dialog=Wade.dialog; var imgArry=[     "unknow.gif",       "txt.gif",     "hlp.gif",   "doc.gif",    "pdf.gif",     "ppt.gif",     "mdb.gif",     "pic.gif",   "code.gif",   "htm.gif",     "zip.gif",     "exe.gif",     "mp.gif",    "rm.gif",   "audio.gif",   "xls.gif"    ]; var typeLink={       "TXT":1,"CHM":2,"HLP":2,"DOC":3,"PDF":4,"PPT":5,"PPS":5,"MDB":6,       "GIF":7,"JPG":7,"PNG":7,"BMP":7,"ASP":8,"JSP":8,"JS":8,"PHP":8,       "PHP3":8,"ASPX":8,"HTM":9,"HTML":9,"SHTML":9,"ZIP":10,"RAR":10,       "EXE":11,"AVI":12,"MPG":12,"MPEG":12,"ASF":12,"RA":13,"RM":13,       "MID":14,"WAV":14,"MP3":14,"MIDI":14,"XLS":15 };  return {  unInit:function(){   imgArry=[];delete imgArry;imgArry=null;   delete typeLink;typeLink=null;  },  getFileName:function(full_name) {   var f,full_name = full_name.replace('\\', '/');   var index = full_name.lastIndexOf("/");   f=(index == -1 ? full_name : full_name.substring(index + 1, full_name.length));    return f;  },  getFileImage:function(filename) {   var type =(typeof(filename)=="string" && filename!="")?filename.substring(filename.lastIndexOf(".") + 1).toUpperCase():"";   var image=imgArry[0];   if(typeof(type)=="string" && type!=""){    if(typeLink[type])image=imgArry[typeLink[type]];   }type=null;   image="component/images/file/" + image;return image;  }    };})();Wade.pub(Wade.upload);Wade.criteria=(function(){ var util=Wade.util; var dom=Wade.dom; var context=Wade.context; var dialog=Wade.dialog;    return {    encodeCriteria:function (theForm) {   if(typeof(Wade.component.query)=='undefined') Include('component/query.js');      var str = "";   var count = 0;      for (var i=0; i<theForm.elements.length; i++) {    var element = theForm.elements[i];    var name = element.name;    var desc = element.getAttribute("desc");    var value = element.value;    var text = element.value;     var isvalid = false;        if (element.tagName == "INPUT" || element.tagName == "SELECT" || element.tagName == "TEXTAREA") {     if (name == null || desc == null || value == null) {      continue;     }     else if (element.type.toUpperCase() == "TEXT") {            if (value == "") continue;      if (element.getAttribute("fieldName") != null && dom.getElement(element.getAttribute("fieldName")) != null) {       continue;      }      isvalid = true;     }     else if (element.type.toUpperCase() == "HIDDEN") {      if (element.getAttribute("textName") != null) {       var popfield = dom.getElement(element.getAttribute("textName"));       if (popfield != null) text = popfield.value;      }      if (value == "" && text == "") continue;      isvalid = true;     }     else if (element.tagName == "SELECT") {      if (value == "") continue;      text = element.options[element.selectedIndex].text;      isvalid = true;     }     else if (element.tagName == "TEXTAREA") {      if (value == "") continue;      isvalid = true;     }     else if (element.type.toUpperCase() == "CHECKBOX"){      if(!element.checked) continue;      isvalid = true;     }     else if(element.type.toUpperCase() == "RADIO"){      if(!element.checked) continue;      isvalid = true;     }          if (isvalid) {      count ++;      str += util.getStrByPadLength(name) + util.getStrByPadLength(desc) + util.getStrByPadLength(value) + util.getStrByPadLength(text);     }    }   }      var qrystr = util.getStrByPadPrefix(4) + util.getStrByPadPrefix(count) + str;   var datas = this.decodeCriteria(qrystr);      parent.getElement("CRIT_REMARK").value = qrystr;   parent.getElement("QUERY_DESC").innerText = datas["DESC"];   Wade.page.cancel(true);  },  decodeCriteria:function(encodestr) {   var encodename = ["NAME","DESC","VALUE","TEXT"];      var urlstr = "", descstr = "";   var array = util.getArrayByEncodeStr(encodename, encodestr);   parent.getElement("CRIT_CONDITION").innerHTML = "";   for (var i=0; i<array.length; i++) {    var name = array[i]["NAME"];    var desc = array[i]["DESC"];    var value = array[i]["VALUE"];    var text = array[i]["TEXT"];        if (parent.getElement(name) == null) {     var element = parent.document.createElement("INPUT");     element.setAttribute("type", "hidden");     element.setAttribute("name", name);     element.setAttribute("value", value);     parent.getElement("CRIT_CONDITION").appendChild(element);    }    urlstr += "&" + name + "=" + value;    descstr += desc + "=" + text + (i != array.length - 1 ? ", " : "");   }   return { "URL" : urlstr, "DESC" : descstr };  },    exportFile:function (page, listener, params, privcode, info, oper_mod) {   if (privcode != null && !hasPriv("COM_SIMPLEEXP_" + privcode)) {    alert("\u60A8\u6CA1\u6709\u6279\u91CF\u5BFC\u51FA\u6743\u9650\uFF0C\u65E0\u6CD5\u7EE7\u7EED\u64CD\u4F5C\uFF01\u005C\u006E\u5982\u679C\u9700\u8981\u64CD\u4F5C\u6B64\u529F\u80FD\uFF0C\u8BF7\u4E0E\u7BA1\u7406\u4EBA\u5458\u8054\u7CFB\uFF01");    return false;   }   var result = window.confirm(info == null ? "\u786E\u5B9A\u5BFC\u51FA\u5417\uFF1F" : info);   if (!result) return false;   try {    beginPageLoading();    if (oper_mod != null && getVersion() != "BOSS15") {     redirectTo(page, "createQryLog", "&CRIT_CLASS=" + oper_mod + "&OPER_TYPE=EXP&CRIT_DESC=" + getElementValue("QUERY_DESC"), "qryframe");    }    var exportResult = redirectTo(page, listener, params, "printframe");    setTimeout("endPageLoading()", 6000);    return exportResult;   } catch (e) {    alert("\u5BFC\u51FA\u53D1\u751F\u5F02\u5E38\uFF0C\u60A8\u7684\u6D4F\u89C8\u5668\u7248\u672C\u8FC7\u4F4E\u6216\u6D4F\u89C8\u5668\u5B89\u5168\u8BBE\u7F6E\u8FC7\u9AD8\uFF0C\u5BFC\u81F4\u70B9\u51FB\u4E00\u6B21\u5BFC\u51FA\u5E76\u4FDD\u5B58\u6587\u4EF6\u540E\uFF0C\u5982\u679C\u4E0D\u5237\u65B0\u6216\u91CD\u65B0\u6253\u5F00\u8BE5\u9875\u9762\u800C\u518D\u6B21\u70B9\u51FB\u5BFC\u51FA\u5C06\u4F7F\u5BFC\u51FA\u65E0\u6CD5\u6267\u884C\u005C\u006E\u5982\u679C\u8981\u89E3\u51B3\u6B64\u95EE\u9898\uFF0C\u6709\u4EE5\u4E0B\u4E09\u79CD\u65B9\u5F0F\uFF1A\u005C\u006E\u0031\u3001\u5347\u7EA7\u6D4F\u89C8\u5668\u7248\u672C\u005C\u006E\u0032\u3001\u5BFC\u51FA\u5E76\u4FDD\u5B58\u6587\u4EF6\u540E\u91CD\u65B0\u6253\u5F00\u6216\u5237\u65B0\u8BE5\u9875\u9762\u005C\u006E\u0033\u3001\u5BFC\u51FA\u6587\u4EF6\u65F6\u4E0D\u8981\u76F4\u63A5\u4FDD\u5B58\u6587\u4EF6\uFF0C\u800C\u662F\u9009\u62E9\u6253\u5F00\u6587\u4EF6\uFF0C\u7136\u540E\u5728\u6253\u5F00\u7684\u6587\u4EF6\u4E2D\u4FDD\u5B58\u6587\u4EF6");   }   return true;  }   };})();Wade.pub(Wade.criteria);Wade.print=(function(){ var dh=System.DomHelper; var dom=Wade.dom; function HtmlPrint() {  this.hkey_root = "HKEY_CURRENT_USER";  this.hkey_path = "\\Software\\Microsoft\\Internet Explorer\\PageSetup\\";  this.need_border = true;  this.printframe = getFrame("printframe"); } HtmlPrint.prototype={  clearHeaderAndFooter:function() {   this.setHeaderAndFooter("", "");  },  setHeaderAndFooter:function() {   this.setHeaderAndFooter("&w&b\u9875\u7801\uFF0C&p/&P", "&u&b&d");  },  setHeaderAndFooter:function(header, footer) {   try {    var regwsh = new ActiveXObject("WScript.Shell");    var hkey_key = "header";        regwsh.RegWrite(this.hkey_root + this.hkey_path + hkey_key, header);    hkey_key = "footer";    regwsh.RegWrite(this.hkey_root + this.hkey_path + hkey_key, footer);   } catch(e){}  },  setNeedBorder:function(need_border) {   this.need_border = need_border;  },  getPrintObject:function(obj) {   this.clearHeaderAndFooter();   var o=obj;if(typeof(obj)=="string" && obj!="")o=document.getElementById(obj);   if(this.printframe && this.printframe.document &&      this.printframe.document.body && o && o.nodeType){    var ph=this.printframe.document.getElementsByTagName("HEAD")[0];    var ch=document.getElementsByTagName("HEAD")[0];    if(ph && ph.nodeType && ch && ch.nodeType){     var css=dom.getChildsByRecursion(ch,"link","href");     for(var i=0;i<css.length;i++){      var link  = this.printframe.document.createElement("LINK");            link.setAttribute("href",css[i].getAttribute("href"));             link.setAttribute("type","text/css");            link.setAttribute("rel","Stylesheet");            ph.insertBefore(link, ph.firstChild);     }css=null;    }ch=null;ph=null;    this.printframe.document.body.innerHTML = "";    dh.insertHtml("afterbegin",this.printframe.document.body,"");    dh.insertHtml("beforeend",this.printframe.document.body,o.outerHTML);    return this.printframe.document.body.firstChild;   }   return null;  },  printRaw:function(objname) {   if (window.confirm("\u786E\u5B9A\u6253\u5370\u5417\uFF1F")) {    var newobj = this.getPrintObject(objname);    if(newobj && newobj.nodeType){     newobj.style.display = "";     if (this.need_border){      newobj.style.borderCollapse = "collapse";      newobj.borderColor = "#000000";     }     newobj.bgColor = "#FFFFFF";     newobj.style.fontSize = "12px";             this.printframe.focus();     this.printframe.print();    }newobj=null;   }  },    print:function (objname, encodehead, encodewidth, isdelete, removehead, title, info, footer) {   if (window.confirm("\u786E\u5B9A\u6253\u5370\u5417\uFF1F")) {    var newobj = this.getPrintObject(objname);    if(!newobj || !newobj.nodeType) return;    if(newobj.tagName.toUpperCase()!="TABLE"){alert("\u6253\u5370\u7684\u5BF9\u8C61\u5E76\u975E\u0054\u0061\u0062\u006C\u0065");return;}    newobj.style.display = "";    if (this.need_border) {     newobj.border = "1";     newobj.style.borderCollapse = "collapse";    }    newobj.borderColor = "#000000";    newobj.bgColor = "#FFFFFF";    newobj.style.fontSize = "12px";        var header = newobj.rows[0];    header.style.textAlign = "center";        var hcells = header.cells;    var celllength = hcells.length;    var headlength = encodehead && encodehead != "" ? encodehead.split(",").length : 0;    var colspan = isdelete ? celllength - headlength : headlength != 0 ? headlength : celllength;      if (encodehead && encodehead != "") {     var rows = newobj.rows;     var heads = encodehead.split(",");     var widths = encodewidth && encodewidth != '' ? encodewidth.split(",") : null;     var row,cells;     var cell,width,isexist;     for (var i=0; i<rows.length; i++) {      row = rows[i];      if (isdelete) {       for (var j=0; j<heads.length; j++) {        cells = row.cells;        for (var k=0; k<cells.length; k++) {         cell = cells[k];         cell.id = hcells[k].id;         if (cell.id == "col_" + heads[j]) {          cell.style.display = "none";          break;         }        }       }      } else {       cells = row.cells;       for (var j=0; j<cells.length; j++) {        cell = cells[j];        cell.id = hcells[j].id;        width = cell.width;        isexist = false;        for (var k=0; k<heads.length; k++) {         if (cell.id == "col_" + heads[k]) {          isexist = true;          if (widths && widths[k] != "") width = widths[k];          break;         }        }        if (!isexist) {         cell.style.display = "none";        } else {         cell.width = width;        }       }      }     }     rows =null;heads = null;     widths =null;row=null,cells=null;     cell=null;width=null;isexist=null;    }       if (removehead) newobj.deleteRow(0);    if (info && info != '') {     var inforow = newobj.insertRow(0);     var infocell = inforow.insertCell(0);     infocell.innerHTML = info;     infocell.colSpan = colspan;     inforow=null;infocell=null;    }    if (title && title != '') {     var titlerow = newobj.insertRow(0);     var titlecell = titlerow.insertCell(0);     titlecell.innerHTML = title;     titlecell.colSpan = colspan;     titlecell.align = "center";     titlecell.height = "20";     titlecell.style.fontSize = "20px";     titlecell.style.fontWeight = "bold";     titlerow=null;titlecell=null;    }        if (footer) {     var footerrow = newobj.insertRow(newobj.rows.length);     var footercell = footerrow.insertCell(0);     footercell.innerHTML = footer;     footercell.colSpan = colspan;     footercell.height = "100";     footerrow=null;footercell=null;    }        this.printframe.focus();    this.printframe.print();    header=null;newobj=null;   }  }      }; return {  printRaw:function (objname) {   new HtmlPrint().printRaw(objname);  },  print:function(objname, encodehead, encodewidth, isdelete, removehead, title, info, footer) {   new HtmlPrint().print(objname, encodehead, encodewidth, isdelete, removehead, title, info, footer);  }   };})();Wade.component={};Wade.component.baseComponent=function(){ };Wade.component.baseComponent.prototype={ };Wade.log=(function(){ var context=Wade.context;  var dlg=null,outputEl=null; function createDebugConsole(){  if(!context.isProductMode() && document.body){       dlg = new System.UI.Components.BasicDialog("wade_log_console", {     autoCreate:true,                    shadow: true,                    draggable: true,                    resizable:false,                    modal: false,                    fixedcenter:false,                    shim:true,                    width:400, height:200,                    x:1,y:1,                    title:"Js Debug Output"                });   outputEl = dlg.body.createChild({                tag:"textarea",                style:{width:"375px",height:"150px"}            });  } } function outPutMessage(info,t){  if(!context.isProductMode()){   if(dlg==null || outputEl==null){createDebugConsole();}   if(!dlg.isVisible()){dlg.show();}   try{outputEl.dom.value+=t+":" + info + "\n";}catch(e){alert("\u4E0D\u5408\u6CD5\u7684\u9519\u8BEF\u4FE1\u606F\u5B57\u7B26\u4E32\u0021");}  }else{alet(info);} }  return {  debug:function(info) {   outPutMessage(info,"debug");  },  info:function(info) {   outPutMessage(info,"info");  },  warn:function(info) {   if (!context.isProductMode()) {    outPutMessage(info,"warn");   }  },  error:function (info){   outPutMessage(info,"error");  }   };})();System.onReady(function(){ var hk=Wade.context.getHotKey();if(typeof(hk)=="string" && hk!=""){Wade.event.setHotkey(hk);} System.EventManager.on(document,"keydown",Wade.event.onDocumentKeyDownEvent); System.EventManager.on(document,"keypress",Wade.event.onDocumentKeyPressEvent);  if(Wade.context.isProductMode()){System.EventManager.on(document,"contextmenu", Wade.event.onDocumentContextmenuEvent);}});System.EventManager.on(window,"load",function(){ if(Wade.page.onPageLoad()!=false){  System.runLoadEvents();  if(System.UserAgent.ie){var f=document.getElementById("wade_sbtframe");if(f && f.nodeType){   System.EventManager.on(f,"readystatechange",Wade.event.onSbtframeReadyStateChange);  f=null;}} }});System.EventManager.on(window,"unload",function(){ System.EventManager.un(document,"keydown",Wade.event.onDocumentKeyDownEvent); System.EventManager.un(document,"keypress",Wade.event.onDocumentKeyPressEvent);  if(Wade.context.isProductMode()){System.EventManager.un(document,"contextmenu",Wade.event.onDocumentContextmenuEvent);} if(System.UserAgent.ie){var f=document.getElementById("wade_sbtframe");if(f && f.nodeType){  System.EventManager.un(f,"readystatechange",Wade.event.onSbtframeReadyStateChange); f=null;}}   Wade.dialog.unInit(); Wade.context.unInit(); Wade.upload.unInit();  if(System.UI && typeof(System.UI.Components.DialogManager)!="undefined"){  System.UI.Components.DialogManager.destroy(); }  if(Wade.component && typeof(Wade.component.TabSetManager)!="undefined"){  Wade.component.TabSetManager.destroy(); } if(Wade.component && typeof(Wade.component.ComboBoxManager)!="undefined"){  Wade.component.ComboBoxManager.destroy(); } System.CG();});System.onLoad(function() { var ctx=Wade.context.getPageVisit(); var frm=document.forms[0]; if(frm && frm.nodeType){  var act=frm.getAttribute("action");  if(act){   if(act.indexOf("?")>-1){act+="&";}else{act+="?"}   if(ctx.staffId){act+="staffId=" + ctx.staffId + "&";}   if(ctx.epachyId){act+="eparchyCode=" + ctx.epachyId + "&";}   act+="wade_randomcode="+ Math.random();   frm.setAttribute("action",act);  }act=null; }frm=null; var is=Wade.context.getInitScript(); if(typeof(is)=='string' && is!=''){  eval("if(typeof(" + is +")=='function')" + is + "();"); }is=null; });Wade.context.getPageVisit();})();