(function(){var util=Wade.util;var dom=Wade.dom;var evt=Wade.event;var context=Wade.context; var verifylib=Wade.verifylib;var ajax=Wade.ajax;Wade.navMenu=(function(){   var touchNotifyTask; var touchNotifyError=false; var dbctrlwin = null;  function getDbctrlWin() {  if (dbctrlwin == null) return dbctrlwin;  try {   dbctrlwin.document;  } catch (e) {   return null;  }  return dbctrlwin; };  function submitAsForm(url, target) {  var submitForm = document.createElement("FORM");  document.body.appendChild(submitForm);  submitForm.method = "POST";  submitForm.target=target;  submitForm.action= url;  submitForm.submit();  submitForm=null; };  function turnOnDbdisplay(initurl) {  var padding = 25, width = 400, height = 200;  var top = padding, left = screen.width - width - padding;    var purl = parent.location.href;  purl = purl.substring(0, purl.indexOf("?"));  purl = purl.substring(0, purl.lastIndexOf("/"));    var url = purl + "/" + context.getPageUrl('component.dbdisplay.DbdisplayCtrl','',(initurl != null && initurl != '' ? '&INITURL=' + initurl.replace('&listener', '_listener') : ''));  url=util.setRandomParam(url);    dbctrlwin = window.open("", "dbctrlwin", "width=" + width + ", height=" + height + ", top=" + top + ", left=" + left + ", toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=yes");   submitAsForm(context.getSysAddr(url), "dbctrlwin"); }; function touchNotifyByTimeout() {  ajax.setAjaxLoading(true);  var navmsgarea=document.getElementById("navmsgarea");  var msgs=[];  if(navmsgarea && navmsgarea.nodeType){      var links=getChildsByRecursion(navmsgarea,"span","tag","notify");   if(links && links.length){    var notifyType,showNavCount=0;    msgs.push("<ul>");    for(var i=0;i<links.length;i++){     notifyType=links[i].getAttribute("notifytype");     if(notifyType=="nav"){      showNavCount++;      links[i].style.display="";     }else{      msgs.push("<li style=\"margin-top:2px;\">" + links[i].innerHTML + "</li>");      if(notifyType=="all"){       showNavCount++;       links[i].style.display="";      }else{       links[i].style.display="none";      }     }    }    msgs.push("</ul>");   }links=null;   if(showNavCount>0){    dom.hidden("navnotify", false);   }else{    dom.hidden("navnotify", true);   }  }navmsgarea=null;    if(msgs.length>0){   var pnc=document.getElementById("popupNotifyContent");   if(pnc && pnc.nodeType){    var content=msgs.join("");    pnc.innerHTML=content;    if(parent && parent.Wade      && content!="" && content.indexOf("li")>0){     parent.Wade.popupMessage.popup(content);    }    content=null;   }pnc=null;   }msgs=null;   }  function parseResposeXml(r){  var xml;  if(System.UserAgent.ie){            xml = new ActiveXObject("Msxml2.FreeThreadedDOMDocument");            xml.async=false;xml.resolveExternals = false;            xml.loadXML(r.responseText);        }else{            xml = (new DOMParser()).parseFromString(r.responseText, "text/xml");        }         root = xml.documentElement || xml;  if(root==null || root.nodeName!="parts"){   touchNotifyError=true;     }else{   var content,part,partId,partElement,partNodes = root.childNodes;   for (var i = 0; i < partNodes.length; i++) {    part=partNodes[i];    if (part.attributes) {     partId = part.attributes[0].value;     partElement = document.getElementById(partId);     if (partElement) {      if (part.childNodes != null && part.childNodes.length > 0) {       content = "";       for (var ii = 0; ii < part.childNodes.length; ii++) {        content += part.childNodes[ii].nodeValue;       }       if(content){content=content.trim();}       if(content!="" && content.indexOf("marquee")>-1 && partElement.innerHTML!=content){        partElement.style.display="";        partElement.innerHTML = content;                 touchNotifyByTimeout();       }else{                partElement.style.display="none";       }       } else {       partElement.innerHTML="";      }     }    }   }   partElement=null;partId=null;content=null;part=null;   partNodes=null;  }  root=null;xml=null;r=null; } return {  NAV_MENU_CURSOR:0,  ACTIV_NAVFRAME_IDX:null,  PREVIOUS_NAVFRAME_IDX:null,  HOLD_FIRST_PAGE:false,  turnOnDbdisplay:function(initurl){   turnOnDbdisplay(initurl);  },  init:function(){   var t,f=dom.getElementValue("notifyFrequency");   if(f && /^\d+$/.test(f)){t=parseInt(f);}else{ t=5;}   touchNotifyTask={     run:Wade.navMenu.touchNotify,        interval:t* 60 * 1000    };   System.TaskMgr.start(touchNotifyTask);   },   destroy:function(){   System.TaskMgr.stop(touchNotifyTask);   touchNotifyTask=null;   getDbctrlWin=null;   submitAsForm=null;   turnOnDbdisplay=null;   touchNotifyByTimeout=null;    parseResposeXml=null;  },   touchNotify:function(){   if(touchNotifyError==true){return false;}   var notify=document.getElementById("notify");   if (notify && notify.value && notify.value=="true"){    ajax.setAjaxLoading(false);    var url=context.getAsyncUrl("component.NavMenu", "queryNotifys", null, "NotifysPart",false);    ajax.get(url,window,parseResposeXml);   }notify=null;   return true;  },  getDbctrlWin:function(){   return getDbctrlWin();  }   }})();System.onLoad(Wade.navMenu.init,Wade.navMenu);System.EventManager.on(window,"unload",Wade.navMenu.destroy);Wade.pub(Wade.navMenu);Wade.navMenu.Controler=(function(){ var turnLeft = 0; var turnRight = 0; var stepNum = 50; var curNum = stepNum; var loop = false; var navmenus = null;    function turnRegisterUp() {  loop = true;  System.EventManager.on(document,'mouseup',Wade.navMenu.Controler.turnMouseUp); };  function moveNavMenu(){  if (loop == false) return;  if(!navmenus)navmenus=document.getElementById("navmenus");  if(!navmenus) return;  var marginLeft = navmenus.style.marginLeft;  if (typeof(marginLeft) == 'undefined' || marginLeft == '') {   marginLeft = "0px";     }     var exp = /^(-)?(\d+)px$/ig;     exp=exp.exec(marginLeft);     if (exp !=null && exp.length && exp.length == 3) {   if(typeof(exp[1])=='undefined')exp[1]='';         marginLeft = parseInt((parseInt(exp[1] + exp[2]) + curNum)) + "px";         navmenus.style.marginLeft = marginLeft;     }     window.setTimeout(moveNavMenu, 100); };  return {  turnLeftMouseDown:function(){   turnRegisterUp();   curNum = stepNum;   moveNavMenu();  },    turnRightMouseDown:function(){   turnRegisterUp();   curNum = parseInt(0-stepNum);   moveNavMenu();  },  turnMouseUp:function() {   loop = false;   System.EventManager.un(document,'mouseup',Wade.navMenu.Controler.turnMouseUp);  },   resetNavMenus:function(){     var navmenus=document.getElementById("navmenus");     if(navmenus && navmenus.nodeType){      navmenus.style.marginLeft = "0px";      }navmenus=null;  }   };})();})();