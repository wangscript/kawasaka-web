opener = window.dialogArguments;var _editor_url = opener._editor_url;var objname     = location.search.substring(1,location.search.length);var config      = opener.document.all[objname].config;var editor_obj  = opener.document.all["_" +objname+  "_editor"];var editdoc     = editor_obj.contentWindow.document;function _CloseOnEsc() {  if (event.keyCode == 27) { window.close(); return; }};window.onerror = HandleError;function HandleError(message, url, line) {  var str = "An error has occurred in this dialog." + "\n\n"  + "Error: " + line + "\n" + message;  alert(str);  return true;};function Init() {  document.body.onkeypress = _CloseOnEsc;};function _isValidNumber(txtBox) {  var val = parseInt(txtBox);  if (isNaN(val) || val < 0 || val > 9999) { return false; }  return true;};function btnOKClick() {  var curRange = editdoc.selection.createRange();    var checkList = ['rows','cols','border','cellspacing','cellpadding'];  var checkDesc = ['行数','列数','表格边框','单元格间距','单元格边距'];  for (var idx in checkList) {    var fieldname = checkList[idx];    if (document.all[fieldname].value == "") {      alert(checkDesc[idx] + "不能为空!");      document.all[fieldname].focus();      return;    }    else if (!_isValidNumber(document.all[fieldname].value)) {      alert(checkDesc[idx] + "必须为整数！");      document.all[fieldname].focus();      return;    }  }    if (editdoc.selection.type == "Control" || curRange.htmlText) {    if (!confirm("Overwrite selected content?")) { return; }    curRange.execCommand('Delete');    curRange = editdoc.selection.createRange();  }    var table = '<table border="' +document.all.border.value+ '"'     + ' style="border:1px solid; border-collapse:collapse;"'            + ' cellspacing="' +document.all.cellspacing.value+ '"'            + ' cellpadding="' +document.all.cellpadding.value+ '"'            + ' width="' +document.all.width.value + document.all.widthExt.value+ '"'            + ' align="' +document.all.alignment.value+ '">\n';  for (var x=0; x<document.all.rows.value; x++) {    table += " <tr>\n";    for (var y=0; y<document.all.cols.value; y++) {      table += "  <td></td>\n";    }    table += " </tr>\n";  }  table += "</table>\n";    opener.editor_insertHTML(objname, table);      window.close();};