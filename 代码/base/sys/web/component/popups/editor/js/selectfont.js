var fonts = { "Arial":           "arial, helvetica, sans-serif", "Courier New":     "courier new, courier, mono", "Georgia":         "Georgia, Times New Roman, Times, Serif", "Tahoma":          "Tahoma, Arial, Helvetica, sans-serif", "Times New Roman": "times new roman, times, serif", "Verdana":         "Verdana, Arial, Helvetica, sans-serif", "impact":          "impact", "WingDings":       "WingDings",    "仿宋体":           "仿宋体",    "黑体":             "黑体",    "楷体":             "楷体",    "隶书":             "隶书",    "宋体&新宋体":       "宋体&新宋体",      "幼圆":             "幼圆"};var previewText = 'AaBbCcDdEeFfGgHhIiJj';function init() { document.body.onkeypress = closeOnEsc; renderFonts(); updatePreview(true);}function closeOnEsc() { if (event.keyCode == 27) { window.close(); return; }}function renderFonts() { for (var font in fonts) {  var newElm = new Option(font, font, false, false);  document.form1.elements['fontFace'].options[document.form1.elements['fontFace'].length] = newElm; }}function getInitSettings() { var editdoc = window.dialogArguments;  var Bold = editdoc.queryCommandValue('Bold') ?  "Bold" : ""; var Italic = editdoc.queryCommandValue('Italic') ? "Italic" : ""; var Style = Bold + (Bold != "" && Italic != "" ? " " : "") + Italic;  var paramObj = new Object; paramObj.fontFace      = editdoc.queryCommandValue('FontName'); paramObj.fontStyle     = Style; paramObj.fontSize      = editdoc.queryCommandValue('FontSize'); paramObj.underline     = editdoc.queryCommandValue('Underline'); paramObj.strikeThrough = editdoc.queryCommandValue('StrikeThrough'); paramObj.superScript   = editdoc.queryCommandValue('SuperScript'); paramObj.subScript     = editdoc.queryCommandValue('SubScript'); document.form1.elements['fontFace'].value        = paramObj.fontFace; document.form1.elements['fontStyle'].value       = paramObj.fontStyle; document.form1.elements['fontSize'].value        = paramObj.fontSize; document.form1.elements['underline'].checked     = paramObj.underline; document.form1.elements['strikeThrough'].checked = paramObj.strikeThrough; document.form1.elements['superScript'].checked   = paramObj.superScript; document.form1.elements['subScript'].checked     = paramObj.subScript; return paramObj;}function getCollSettings() { var paramObj = new Object; paramObj.fontFace      = document.form1.elements['fontFace'].value; paramObj.fontStyle     = document.form1.elements['fontStyle'].value; paramObj.fontSize      = document.form1.elements['fontSize'].value; paramObj.underline     = document.form1.elements['underline'].checked; paramObj.strikeThrough = document.form1.elements['strikeThrough'].checked; paramObj.superScript   = document.form1.elements['superScript'].checked; paramObj.subScript     = document.form1.elements['subScript'].checked; return paramObj;}function updatePreview(init) { var paramObj = init ? getInitSettings() : getCollSettings(); var startTag = ''; var endTag   = ''; startTag += '<font face="' + paramObj.fontFace + '" size="' + paramObj.fontSize + '">'; endTag   += '</font>'; switch (paramObj.fontStyle) {  case 'Regular':   break;  case 'Italic':   startTag += '<i>';   endTag    = '</i>' + endTag;   break;  case 'Bold':   startTag += '<b>';   endTag    = '</b>' + endTag;   break;  case 'Bold Italic':   startTag += '<b><i>';   endTag    = '</i></b>' + endTag;   break; } if (paramObj.underline) {  startTag += '<u>';  endTag    = '</u>' + endTag; } if (paramObj.strikeThrough) {  startTag += '<strike>';  endTag    = '</strike>' + endTag; } if (paramObj.superScript) {  startTag += '<sup>';  endTag    = '</sup>' + endTag; } if (paramObj.subScript) {  startTag += '<sub>';  endTag    = '</sub>' + endTag; }  document.getElementById('previewDiv').innerHTML = startTag + previewText + endTag;}function setEditdoc() { var editdoc = window.dialogArguments; var font = getCollSettings(false); editdoc.execCommand("FontName", 0, font.fontFace); editdoc.execCommand("FontSize", 0, font.fontSize);  if (editdoc.queryCommandValue('Bold')) editdoc.execCommand('Bold'); if (editdoc.queryCommandValue('Italic')) editdoc.execCommand('Italic'); if (font.fontStyle != "") {  var styles = font.fontStyle.split(" ");  for (var i=0; i<styles.length; i++) editdoc.execCommand(styles[i]); } if (font.underline || editdoc.queryCommandValue("Underline")) editdoc.execCommand("Underline"); if (font.strikeThrough || editdoc.queryCommandValue("StrikeThrough")) editdoc.execCommand("StrikeThrough"); if (font.superScript || editdoc.queryCommandValue("SuperScript")) editdoc.execCommand("SuperScript"); if (font.subScript || editdoc.queryCommandValue("SubScript")) editdoc.execCommand("SubScript"); }function selectFont() { setEditdoc(); window.close();}function selectScript(obj) { var sup = document.all['superScript']; var sub = document.all['subScript']; if (sup.checked && sub.checked) {  if (sup == obj) sub.checked = false;  if (sub == obj) sup.checked = false; }}