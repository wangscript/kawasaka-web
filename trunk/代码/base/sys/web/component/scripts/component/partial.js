(function(){if(typeof(Wade.component.ajaxComponentPartial)=='undefined'){ Wade.component.ajaxComponentPartial=(function(){ var util=Wade.util; var dom=Wade.dom; var evt=Wade.event; var ajax=Wade.ajax;  function buildReqUrl(obj,url,parts,load,jsparam){  var link = url;  if (!jsparam) {   jsparam = obj.getAttribute('jsparam');   if(typeof(jsparam)!='string')jsparam = "";   }  link = link + "$parts";    var partIds="/";  if(parts instanceof Array){   partIds+=parts.join("/");  }else{   partIds+=(parts.split(",")).join("/");  }  var index = link.indexOf("$parts");  var reqUrl="";  if (index != -1) {   var url1 = link.substr(0, index);   var url2 = link.substr(index);   reqUrl = url1.replace(new RegExp("&sp=(.*)"), partIds + "&sp=$1");   if (url1 == reqUrl) {reqUrl = reqUrl + partIds;}   reqUrl = reqUrl + url2.replace("$parts", "");  } else {   reqUrl = link.replace(new RegExp("&sp=(.*)"), partIds + "&sp=$1");   if (link == reqUrl) {reqUrl = reqUrl + partIds;}  }   reqUrl = reqUrl + jsparam + "&rand=" + Math.random();   return reqUrl;   };  return {  ajaxDirectOld:function(obj,url,parts,load,jsparam,afteraction){   this.afterAction=afteraction;   var reqUrl=buildReqUrl(obj,url,parts,load,jsparam);   ajax.get(reqUrl,this,true);  },  ajaxSubmitOld:function(obj,url, parts, formIds, load, jsparam, afteraction) {   this.afterAction=afteraction;   var reqUrl=buildReqUrl(obj,url,parts,load,jsparam);      var ele='';   var formNode;   if (formIds) {    formIds = formIds.split(",");    for(i=0;i<formIds.length;i++){    formNode=document.getElementById(formIds[i]);      if (!formNode){      alert("can't get form (" + formIds[i] + ")");      continue;     }     ele+=ajax.buildFormData(formNode);    }   } else {        formNode = Wade.dom.getParentForm(obj);    if (formNode=='null'){     formNode = document.forms[0];    }    ele=ajax.buildFormData(formNode);   }   ajax.post(reqUrl,this,ele,true);  },  ajaxdo:function(id, param) {   var ajaxLink = document.getElementById(id);   var jsparam = ajaxLink.getAttribute('jsparam')?ajaxLink.getAttribute('jsparam'):'';   param = param?param:'';   ajaxLink.setAttribute('tmpparam',jsparam + param);   evt.fireMouseEvent(id,'click');   }        };})();Wade.pub(Wade.component.ajaxComponentPartial); }})();